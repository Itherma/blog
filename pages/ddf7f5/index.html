<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>打包优化之loader&amp;plugin | sunnyxujian&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon1.ico">
    <meta name="description" content="web前端技术博客,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,react,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#4fc08d">
    <link rel="preload" href="/assets/css/0.styles.280b48f2.css" as="style"><link rel="preload" href="/assets/js/app.d76a6140.js" as="script"><link rel="preload" href="/assets/js/3.724bf448.js" as="script"><link rel="preload" href="/assets/js/5.f79ce4cb.js" as="script"><link rel="preload" href="/assets/js/81.3ca1bc6d.js" as="script"><link rel="prefetch" href="/assets/js/10.33e63f5b.js"><link rel="prefetch" href="/assets/js/100.88170c76.js"><link rel="prefetch" href="/assets/js/101.8d54c91e.js"><link rel="prefetch" href="/assets/js/102.7dff272c.js"><link rel="prefetch" href="/assets/js/103.b5f8461b.js"><link rel="prefetch" href="/assets/js/104.a6516759.js"><link rel="prefetch" href="/assets/js/105.ad5b08fd.js"><link rel="prefetch" href="/assets/js/106.157581cd.js"><link rel="prefetch" href="/assets/js/107.68e05ec4.js"><link rel="prefetch" href="/assets/js/108.76688ddd.js"><link rel="prefetch" href="/assets/js/109.73504a9d.js"><link rel="prefetch" href="/assets/js/11.0de4544b.js"><link rel="prefetch" href="/assets/js/110.289cecf3.js"><link rel="prefetch" href="/assets/js/111.2229d3c3.js"><link rel="prefetch" href="/assets/js/112.b63d71e6.js"><link rel="prefetch" href="/assets/js/113.1b781191.js"><link rel="prefetch" href="/assets/js/114.8d59c3f9.js"><link rel="prefetch" href="/assets/js/115.8e3070e3.js"><link rel="prefetch" href="/assets/js/116.e94d9ee8.js"><link rel="prefetch" href="/assets/js/117.e1ebdb1a.js"><link rel="prefetch" href="/assets/js/118.92597187.js"><link rel="prefetch" href="/assets/js/119.02881f9b.js"><link rel="prefetch" href="/assets/js/12.056774d7.js"><link rel="prefetch" href="/assets/js/120.f7f95b51.js"><link rel="prefetch" href="/assets/js/121.d87b90ad.js"><link rel="prefetch" href="/assets/js/122.8e81d12f.js"><link rel="prefetch" href="/assets/js/123.d1c5d272.js"><link rel="prefetch" href="/assets/js/124.071d3876.js"><link rel="prefetch" href="/assets/js/125.8da325b6.js"><link rel="prefetch" href="/assets/js/126.f3fac94a.js"><link rel="prefetch" href="/assets/js/127.705b0231.js"><link rel="prefetch" href="/assets/js/128.2d0cce43.js"><link rel="prefetch" href="/assets/js/129.136c9093.js"><link rel="prefetch" href="/assets/js/13.c41460b7.js"><link rel="prefetch" href="/assets/js/130.e273b0cd.js"><link rel="prefetch" href="/assets/js/131.1cdc1f03.js"><link rel="prefetch" href="/assets/js/132.e825fb82.js"><link rel="prefetch" href="/assets/js/133.0d293ef7.js"><link rel="prefetch" href="/assets/js/134.a0d635b9.js"><link rel="prefetch" href="/assets/js/135.1af5e654.js"><link rel="prefetch" href="/assets/js/136.bd4c2e25.js"><link rel="prefetch" href="/assets/js/137.e7d9d057.js"><link rel="prefetch" href="/assets/js/138.b2c4087c.js"><link rel="prefetch" href="/assets/js/139.9d81cea3.js"><link rel="prefetch" href="/assets/js/14.6f0de051.js"><link rel="prefetch" href="/assets/js/140.462f2f68.js"><link rel="prefetch" href="/assets/js/141.bfd924b2.js"><link rel="prefetch" href="/assets/js/142.f02c9f6c.js"><link rel="prefetch" href="/assets/js/143.3f153586.js"><link rel="prefetch" href="/assets/js/144.bba01f15.js"><link rel="prefetch" href="/assets/js/145.e6a25735.js"><link rel="prefetch" href="/assets/js/146.cd93e9ca.js"><link rel="prefetch" href="/assets/js/147.63f46f4b.js"><link rel="prefetch" href="/assets/js/148.138380f5.js"><link rel="prefetch" href="/assets/js/149.3980b184.js"><link rel="prefetch" href="/assets/js/15.60153c2f.js"><link rel="prefetch" href="/assets/js/150.7e8cb34a.js"><link rel="prefetch" href="/assets/js/151.559be224.js"><link rel="prefetch" href="/assets/js/152.a51c57fb.js"><link rel="prefetch" href="/assets/js/153.887a69dd.js"><link rel="prefetch" href="/assets/js/154.76aed2e7.js"><link rel="prefetch" href="/assets/js/155.5843b58d.js"><link rel="prefetch" href="/assets/js/156.9b68b27b.js"><link rel="prefetch" href="/assets/js/157.c79c5fef.js"><link rel="prefetch" href="/assets/js/158.3e7d2e05.js"><link rel="prefetch" href="/assets/js/159.ed6b9d8b.js"><link rel="prefetch" href="/assets/js/16.82dd19ed.js"><link rel="prefetch" href="/assets/js/160.37259815.js"><link rel="prefetch" href="/assets/js/161.7a48a04c.js"><link rel="prefetch" href="/assets/js/162.ffd40c22.js"><link rel="prefetch" href="/assets/js/163.eaf5d0ee.js"><link rel="prefetch" href="/assets/js/164.e5353a66.js"><link rel="prefetch" href="/assets/js/165.fe4a33a5.js"><link rel="prefetch" href="/assets/js/166.eb2a137a.js"><link rel="prefetch" href="/assets/js/167.d209e1d2.js"><link rel="prefetch" href="/assets/js/168.e1d97e56.js"><link rel="prefetch" href="/assets/js/169.c96bc779.js"><link rel="prefetch" href="/assets/js/17.c33de90a.js"><link rel="prefetch" href="/assets/js/170.53428bf5.js"><link rel="prefetch" href="/assets/js/171.685b798b.js"><link rel="prefetch" href="/assets/js/172.8127d652.js"><link rel="prefetch" href="/assets/js/173.f63942d1.js"><link rel="prefetch" href="/assets/js/174.7aaff485.js"><link rel="prefetch" href="/assets/js/175.411e5ac1.js"><link rel="prefetch" href="/assets/js/176.e65c95bb.js"><link rel="prefetch" href="/assets/js/177.90e620f4.js"><link rel="prefetch" href="/assets/js/178.d4ea1cdd.js"><link rel="prefetch" href="/assets/js/179.01df97a3.js"><link rel="prefetch" href="/assets/js/18.456e4218.js"><link rel="prefetch" href="/assets/js/180.0f5cda26.js"><link rel="prefetch" href="/assets/js/181.d3f6c371.js"><link rel="prefetch" href="/assets/js/182.18df4323.js"><link rel="prefetch" href="/assets/js/183.ce19b32c.js"><link rel="prefetch" href="/assets/js/184.780c19d0.js"><link rel="prefetch" href="/assets/js/185.8571a197.js"><link rel="prefetch" href="/assets/js/186.716b43aa.js"><link rel="prefetch" href="/assets/js/187.6acda53b.js"><link rel="prefetch" href="/assets/js/188.9460ea0f.js"><link rel="prefetch" href="/assets/js/189.f69905c1.js"><link rel="prefetch" href="/assets/js/19.1223b684.js"><link rel="prefetch" href="/assets/js/190.d0fb2193.js"><link rel="prefetch" href="/assets/js/191.dd8d7bea.js"><link rel="prefetch" href="/assets/js/192.e7ab2686.js"><link rel="prefetch" href="/assets/js/193.e1aef55c.js"><link rel="prefetch" href="/assets/js/194.790d107b.js"><link rel="prefetch" href="/assets/js/195.ce213cdb.js"><link rel="prefetch" href="/assets/js/196.d8e7ce65.js"><link rel="prefetch" href="/assets/js/197.6ca159ed.js"><link rel="prefetch" href="/assets/js/198.1f9103bf.js"><link rel="prefetch" href="/assets/js/199.647fab7d.js"><link rel="prefetch" href="/assets/js/2.900ae423.js"><link rel="prefetch" href="/assets/js/20.bc706733.js"><link rel="prefetch" href="/assets/js/200.5c297a04.js"><link rel="prefetch" href="/assets/js/201.b860990a.js"><link rel="prefetch" href="/assets/js/202.a2dee90c.js"><link rel="prefetch" href="/assets/js/203.6df560c4.js"><link rel="prefetch" href="/assets/js/204.ba95b5a5.js"><link rel="prefetch" href="/assets/js/205.8878cde9.js"><link rel="prefetch" href="/assets/js/206.cf365d5c.js"><link rel="prefetch" href="/assets/js/207.1265f6f6.js"><link rel="prefetch" href="/assets/js/208.d3292fda.js"><link rel="prefetch" href="/assets/js/209.31ad945b.js"><link rel="prefetch" href="/assets/js/21.d5b15a9e.js"><link rel="prefetch" href="/assets/js/210.d4095a65.js"><link rel="prefetch" href="/assets/js/211.da7e7f0b.js"><link rel="prefetch" href="/assets/js/212.86ffee1c.js"><link rel="prefetch" href="/assets/js/213.fc14f988.js"><link rel="prefetch" href="/assets/js/214.276b3100.js"><link rel="prefetch" href="/assets/js/215.977e7988.js"><link rel="prefetch" href="/assets/js/216.245b5975.js"><link rel="prefetch" href="/assets/js/217.e36d5149.js"><link rel="prefetch" href="/assets/js/218.f7b84d56.js"><link rel="prefetch" href="/assets/js/219.b17c2d18.js"><link rel="prefetch" href="/assets/js/22.305d3e0e.js"><link rel="prefetch" href="/assets/js/220.89978bee.js"><link rel="prefetch" href="/assets/js/221.94e9bc2b.js"><link rel="prefetch" href="/assets/js/222.d509002e.js"><link rel="prefetch" href="/assets/js/223.7d5329ab.js"><link rel="prefetch" href="/assets/js/224.d1efb469.js"><link rel="prefetch" href="/assets/js/225.068d1edc.js"><link rel="prefetch" href="/assets/js/226.203df552.js"><link rel="prefetch" href="/assets/js/227.ee66205e.js"><link rel="prefetch" href="/assets/js/228.611dcfa5.js"><link rel="prefetch" href="/assets/js/229.4570cebd.js"><link rel="prefetch" href="/assets/js/23.93f0d1ba.js"><link rel="prefetch" href="/assets/js/230.479fc52e.js"><link rel="prefetch" href="/assets/js/231.ac2939f8.js"><link rel="prefetch" href="/assets/js/232.1b593957.js"><link rel="prefetch" href="/assets/js/233.ed19c07d.js"><link rel="prefetch" href="/assets/js/234.1b8860c5.js"><link rel="prefetch" href="/assets/js/235.099f8d57.js"><link rel="prefetch" href="/assets/js/236.0f2e2794.js"><link rel="prefetch" href="/assets/js/237.c24a3987.js"><link rel="prefetch" href="/assets/js/238.24a8c123.js"><link rel="prefetch" href="/assets/js/239.ebbedd8a.js"><link rel="prefetch" href="/assets/js/24.65c88cda.js"><link rel="prefetch" href="/assets/js/240.61aa403a.js"><link rel="prefetch" href="/assets/js/241.40ae6a14.js"><link rel="prefetch" href="/assets/js/242.37049d18.js"><link rel="prefetch" href="/assets/js/243.8f6dabc9.js"><link rel="prefetch" href="/assets/js/244.00bcd6ce.js"><link rel="prefetch" href="/assets/js/245.2809b552.js"><link rel="prefetch" href="/assets/js/246.8b267a20.js"><link rel="prefetch" href="/assets/js/247.a67df8ec.js"><link rel="prefetch" href="/assets/js/248.4f26a33a.js"><link rel="prefetch" href="/assets/js/249.20bcad31.js"><link rel="prefetch" href="/assets/js/25.a1faceee.js"><link rel="prefetch" href="/assets/js/250.99917a60.js"><link rel="prefetch" href="/assets/js/251.bd763793.js"><link rel="prefetch" href="/assets/js/252.d301841d.js"><link rel="prefetch" href="/assets/js/253.8adc730c.js"><link rel="prefetch" href="/assets/js/254.7696fae3.js"><link rel="prefetch" href="/assets/js/255.dc87c295.js"><link rel="prefetch" href="/assets/js/256.b904c661.js"><link rel="prefetch" href="/assets/js/257.a6a4fd25.js"><link rel="prefetch" href="/assets/js/258.33e5aa35.js"><link rel="prefetch" href="/assets/js/259.412ed2c7.js"><link rel="prefetch" href="/assets/js/26.7af4b05a.js"><link rel="prefetch" href="/assets/js/260.52ff3c31.js"><link rel="prefetch" href="/assets/js/261.c2337769.js"><link rel="prefetch" href="/assets/js/262.0d9bfa34.js"><link rel="prefetch" href="/assets/js/263.c8e4cb6a.js"><link rel="prefetch" href="/assets/js/264.3464e615.js"><link rel="prefetch" href="/assets/js/265.5ef49004.js"><link rel="prefetch" href="/assets/js/27.d31fb32e.js"><link rel="prefetch" href="/assets/js/28.ac365b7a.js"><link rel="prefetch" href="/assets/js/29.4ec37ec1.js"><link rel="prefetch" href="/assets/js/30.8e31ec87.js"><link rel="prefetch" href="/assets/js/31.dbca7833.js"><link rel="prefetch" href="/assets/js/32.13f17495.js"><link rel="prefetch" href="/assets/js/33.84403c7c.js"><link rel="prefetch" href="/assets/js/34.ee01958a.js"><link rel="prefetch" href="/assets/js/35.ee834016.js"><link rel="prefetch" href="/assets/js/36.b27e2b58.js"><link rel="prefetch" href="/assets/js/37.5b9c6529.js"><link rel="prefetch" href="/assets/js/38.571abebc.js"><link rel="prefetch" href="/assets/js/39.7faebe0b.js"><link rel="prefetch" href="/assets/js/4.0a0c1c0f.js"><link rel="prefetch" href="/assets/js/40.c06ef95a.js"><link rel="prefetch" href="/assets/js/41.b1778bfc.js"><link rel="prefetch" href="/assets/js/42.a11eb5b9.js"><link rel="prefetch" href="/assets/js/43.dd5a39d2.js"><link rel="prefetch" href="/assets/js/44.e8f62cfa.js"><link rel="prefetch" href="/assets/js/45.019de3b4.js"><link rel="prefetch" href="/assets/js/46.4313681f.js"><link rel="prefetch" href="/assets/js/47.06396028.js"><link rel="prefetch" href="/assets/js/48.e77c89dd.js"><link rel="prefetch" href="/assets/js/49.a888c246.js"><link rel="prefetch" href="/assets/js/50.c81fd93d.js"><link rel="prefetch" href="/assets/js/51.ae7996b0.js"><link rel="prefetch" href="/assets/js/52.6aab4af3.js"><link rel="prefetch" href="/assets/js/53.0bb5c447.js"><link rel="prefetch" href="/assets/js/54.5ba7adba.js"><link rel="prefetch" href="/assets/js/55.d75ad9b1.js"><link rel="prefetch" href="/assets/js/56.a223d4a4.js"><link rel="prefetch" href="/assets/js/57.070c3d14.js"><link rel="prefetch" href="/assets/js/58.c07df3db.js"><link rel="prefetch" href="/assets/js/59.d468a048.js"><link rel="prefetch" href="/assets/js/6.2b00e463.js"><link rel="prefetch" href="/assets/js/60.0859ac91.js"><link rel="prefetch" href="/assets/js/61.ae4b86ed.js"><link rel="prefetch" href="/assets/js/62.e2e00ad4.js"><link rel="prefetch" href="/assets/js/63.ac9ed636.js"><link rel="prefetch" href="/assets/js/64.64603c0c.js"><link rel="prefetch" href="/assets/js/65.74bb2cbb.js"><link rel="prefetch" href="/assets/js/66.1758262f.js"><link rel="prefetch" href="/assets/js/67.5a3aa8f7.js"><link rel="prefetch" href="/assets/js/68.1c081375.js"><link rel="prefetch" href="/assets/js/69.c21e60d5.js"><link rel="prefetch" href="/assets/js/7.31d17e0f.js"><link rel="prefetch" href="/assets/js/70.8a74bf36.js"><link rel="prefetch" href="/assets/js/71.4492ba25.js"><link rel="prefetch" href="/assets/js/72.3296747e.js"><link rel="prefetch" href="/assets/js/73.c2a46fbe.js"><link rel="prefetch" href="/assets/js/74.366bddf4.js"><link rel="prefetch" href="/assets/js/75.e98af08c.js"><link rel="prefetch" href="/assets/js/76.c00e2544.js"><link rel="prefetch" href="/assets/js/77.a150a751.js"><link rel="prefetch" href="/assets/js/78.f3f879f6.js"><link rel="prefetch" href="/assets/js/79.da538e82.js"><link rel="prefetch" href="/assets/js/8.eb90e2e3.js"><link rel="prefetch" href="/assets/js/80.b1c3e778.js"><link rel="prefetch" href="/assets/js/82.ca162a19.js"><link rel="prefetch" href="/assets/js/83.813d84be.js"><link rel="prefetch" href="/assets/js/84.17e1691d.js"><link rel="prefetch" href="/assets/js/85.dd4423c7.js"><link rel="prefetch" href="/assets/js/86.b25fb906.js"><link rel="prefetch" href="/assets/js/87.66be9b4e.js"><link rel="prefetch" href="/assets/js/88.eadaae8d.js"><link rel="prefetch" href="/assets/js/89.859e72b3.js"><link rel="prefetch" href="/assets/js/9.1d492be9.js"><link rel="prefetch" href="/assets/js/90.cfb6b7b9.js"><link rel="prefetch" href="/assets/js/91.e79aee5d.js"><link rel="prefetch" href="/assets/js/92.68903be5.js"><link rel="prefetch" href="/assets/js/93.60158657.js"><link rel="prefetch" href="/assets/js/94.d2105386.js"><link rel="prefetch" href="/assets/js/95.1c40abf7.js"><link rel="prefetch" href="/assets/js/96.97eb871e.js"><link rel="prefetch" href="/assets/js/97.787d5951.js"><link rel="prefetch" href="/assets/js/98.00721321.js"><link rel="prefetch" href="/assets/js/99.a689649e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.280b48f2.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/favicon1.png" alt="sunnyxujian's blog" class="logo"> <span class="site-name can-hide">sunnyxujian's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><a href="/basic/" class="link-title">前端基础</a> <span class="title" style="display:none;">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/prototype/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/pages/shoucang/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/html/" class="nav-link">HTML和浏览器</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><a href="/framework/" class="link-title">框架</a> <span class="title" style="display:none;">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/pages/vue3/" class="nav-link">Vue3</a></li><li class="dropdown-item"><!----> <a href="/pages/react/" class="nav-link">React</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><a href="/engineering/" class="link-title">工程化</a> <span class="title" style="display:none;">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/engineering/modules/" class="nav-link">基础知识</a></li><li class="dropdown-item"><!----> <a href="/engineering/workflow/" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/engineering/rollup/" class="nav-link">rollup</a></li><li class="dropdown-item"><!----> <a href="/engineering/vite/" class="nav-link">vite</a></li><li class="dropdown-item"><!----> <a href="/engineering/betterConsole/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端进阶" class="dropdown-title"><a href="/advanced/" class="link-title">前端进阶</a> <span class="title" style="display:none;">前端进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/nodejs/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/advanced/net/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/advanced/typescript/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/advanced/codedesign/" class="nav-link">架构设计</a></li><li class="dropdown-item"><!----> <a href="/advanced/optimize/" class="nav-link">性能优化</a></li><li class="dropdown-item"><!----> <a href="/advanced/algorithms/" class="nav-link">数据结构和算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><a href="/notes/" class="link-title">学习笔记</a> <span class="title" style="display:none;">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/javascript/" class="nav-link">JavaScript教程 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/es6/" class="nav-link">ES6 教程 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/typescript-axios/" class="nav-link">TypeScript 从零实现 axios</a></li><li class="dropdown-item"><!----> <a href="/notes/git/" class="nav-link">Git学习 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/render/" class="nav-link">渲染器原理</a></li><li class="dropdown-item"><!----> <a href="/notes/typeScript/" class="nav-link">TypeScript 笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他技术" class="dropdown-title"><a href="/technology/" class="link-title">其他技术</a> <span class="title" style="display:none;">其他技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/techDocs/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/githubUseage/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/pages/techSite/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/techSite/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/pages/usefulSite/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/pages/vueSource/" class="nav-link">Vue资源</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友链&amp;关于" class="dropdown-title"><a href="/friends/" class="link-title">友链&amp;关于</a> <span class="title" style="display:none;">友链&amp;关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友链</a></li><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li></ul></div></div> <a href="https://github.com//sunnyxujian" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://xj-1253772569.file.myqcloud.com/img/mona-loading-default.gif"> <div class="blogger-info"><h3>xujian</h3> <span>劝君惜取少年时。</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><a href="/basic/" class="link-title">前端基础</a> <span class="title" style="display:none;">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/prototype/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/pages/shoucang/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/html/" class="nav-link">HTML和浏览器</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><a href="/framework/" class="link-title">框架</a> <span class="title" style="display:none;">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/pages/vue3/" class="nav-link">Vue3</a></li><li class="dropdown-item"><!----> <a href="/pages/react/" class="nav-link">React</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><a href="/engineering/" class="link-title">工程化</a> <span class="title" style="display:none;">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/engineering/modules/" class="nav-link">基础知识</a></li><li class="dropdown-item"><!----> <a href="/engineering/workflow/" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/engineering/rollup/" class="nav-link">rollup</a></li><li class="dropdown-item"><!----> <a href="/engineering/vite/" class="nav-link">vite</a></li><li class="dropdown-item"><!----> <a href="/engineering/betterConsole/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端进阶" class="dropdown-title"><a href="/advanced/" class="link-title">前端进阶</a> <span class="title" style="display:none;">前端进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/nodejs/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/advanced/net/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/advanced/typescript/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/advanced/codedesign/" class="nav-link">架构设计</a></li><li class="dropdown-item"><!----> <a href="/advanced/optimize/" class="nav-link">性能优化</a></li><li class="dropdown-item"><!----> <a href="/advanced/algorithms/" class="nav-link">数据结构和算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><a href="/notes/" class="link-title">学习笔记</a> <span class="title" style="display:none;">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/javascript/" class="nav-link">JavaScript教程 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/es6/" class="nav-link">ES6 教程 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/typescript-axios/" class="nav-link">TypeScript 从零实现 axios</a></li><li class="dropdown-item"><!----> <a href="/notes/git/" class="nav-link">Git学习 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/render/" class="nav-link">渲染器原理</a></li><li class="dropdown-item"><!----> <a href="/notes/typeScript/" class="nav-link">TypeScript 笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他技术" class="dropdown-title"><a href="/technology/" class="link-title">其他技术</a> <span class="title" style="display:none;">其他技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/techDocs/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/githubUseage/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/pages/techSite/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/techSite/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/pages/usefulSite/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/pages/vueSource/" class="nav-link">Vue资源</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友链&amp;关于" class="dropdown-title"><a href="/friends/" class="link-title">友链&amp;关于</a> <span class="title" style="display:none;">友链&amp;关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友链</a></li><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li></ul></div></div> <a href="https://github.com//sunnyxujian" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础知识</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>webpack</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/engineering/workflow/" class="sidebar-link">webpack运行流程</a></li><li><a href="/pages/cf962f/" class="sidebar-link">webpack5新特性</a></li><li><a href="/pages/bb27bd/" class="sidebar-link">代码分割</a></li><li><a href="/pages/dfb427/" class="sidebar-link">打包优化之config</a></li><li><a href="/pages/ddf7f5/" aria-current="page" class="active sidebar-link">打包优化之loader&amp;plugin</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_1-提取css" class="sidebar-link">1. 提取CSS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_1-1-安装" class="sidebar-link">1.1 安装</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_1-2-webpack-config-js" class="sidebar-link">1.2 webpack.config.js</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_2-指定图片和css目录" class="sidebar-link">2 指定图片和CSS目录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_2-1-webpack-config-js" class="sidebar-link">2.1 webpack.config.js</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_3-压缩js、css和html" class="sidebar-link">3. 压缩JS、CSS和HTML</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_4-purgecss-webpack-plugin" class="sidebar-link">4. purgecss-webpack-plugin</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_5-cdn" class="sidebar-link">5. CDN</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_5-1-使用缓存" class="sidebar-link">5.1 使用缓存</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_5-2-域名限制" class="sidebar-link">5.2 域名限制</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_5-3-文件指纹" class="sidebar-link">5.3 文件指纹</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_5-4-hashplugin" class="sidebar-link">5.4.HashPlugin</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_6-moduleids-chunkids的优化" class="sidebar-link">6.moduleIds &amp; chunkIds的优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_6-1-概念和选项" class="sidebar-link">6.1 概念和选项</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_6-2-webpack-config-js" class="sidebar-link">6.2 webpack.config.js</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_6-3-src-index-js" class="sidebar-link">6.3 src\index.js</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_7-模块联邦" class="sidebar-link">7.模块联邦</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_7-1-动机" class="sidebar-link">7.1.动机</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_7-2-module-federation" class="sidebar-link">7.2.Module Federation</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_7-3-实战" class="sidebar-link">7.3.实战</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_7-4-shared" class="sidebar-link">7.4.shared</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_7-5-双向依赖" class="sidebar-link">7.5.双向依赖</a></li><li class="sidebar-sub-header"><a href="/pages/ddf7f5/#_7-6-多个remote" class="sidebar-link">7.6.多个remote</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>rollup</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vite</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>其他</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-583ea4e9><div class="articleInfo" data-v-583ea4e9><ul class="breadcrumbs" data-v-583ea4e9><li data-v-583ea4e9><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-583ea4e9></a></li> <li data-v-583ea4e9><a href="/engineering" title="工程化-目录页" data-v-583ea4e9>工程化</a></li> <li data-v-583ea4e9><a href="/engineering/#webpack" title="工程化#webpack" data-v-583ea4e9>webpack</a></li> <!----></ul> <div class="info" data-v-583ea4e9><div title="作者" class="author iconfont icon-touxiang" data-v-583ea4e9><a href="https://github.com/sunnyxujian" target="_blank" title="作者" class="beLink" data-v-583ea4e9>xujian</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-583ea4e9><a href="javascript:;" data-v-583ea4e9>2022-04-22</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          打包优化之loader&amp;plugin
        </h1> <!----> <div class="theme-vdoing-content content__default"><p>本篇文章演示通过配置loaders和plugins，优化打包速度，合理设置打包输出的资源的数量及大小。将从以下几个方面着手：
<strong>提取CSS</strong>，
<strong>指定图片和CSS目录</strong>，
<strong>压缩JS、CSS和HTML</strong>，
<strong>去除未使用的 css</strong>，
<strong>配置CDN</strong>，
<strong>moduleIds &amp; chunkIds的优化</strong>，
<strong>模块联邦</strong>。下面将逐个介绍他们的用法和注意事项。</p> <h2 id="_1-提取css"><a href="#_1-提取css" class="header-anchor">#</a> 1. 提取CSS</h2> <ul><li>因为CSS的下载和JS可以并行,当一个HTML文件很大的时候，我们可以把CSS单独提取出来加载</li></ul> <h3 id="_1-1-安装"><a href="#_1-1-安装" class="header-anchor">#</a> 1.1 安装</h3> <ul><li><a href="https://github.com/webpack-contrib/mini-css-extract-plugin" target="_blank" rel="noopener noreferrer">mini-css-extract-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm install  mini<span class="token operator">-</span>css<span class="token operator">-</span>extract<span class="token operator">-</span>plugin <span class="token operator">--</span>save<span class="token operator">-</span>dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_1-2-webpack-config-js"><a href="#_1-2-webpack-config-js" class="header-anchor">#</a> 1.2 webpack.config.js</h3> <p>webpack.config.js</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code>const path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const MiniCssExtractPlugin = require('mini-css-extract-plugin');
</span></span>module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line"> devtool: false,
</span><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: '[name].js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    publicPath: '/'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     { test: /\.txt$/, use: 'raw-loader' },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      { test: /\.css$/, use: [MiniCssExtractPlugin.loader, 'css-loader'] },
</span><span class="token prefix inserted">+</span><span class="token line">      { test: /\.less$/, use: [MiniCssExtractPlugin.loader, 'css-loader', 'less-loader'] },
</span><span class="token prefix inserted">+</span><span class="token line">      { test: /\.scss$/, use: [MiniCssExtractPlugin.loader, 'css-loader', 'sass-loader'] },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">      {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.(jpg|png|gif|bmp|svg)$/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type:'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">       generator:{
</span><span class="token prefix unchanged"> </span><span class="token line">         filename:'images/[hash][ext]'
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">   new HtmlWebpackPlugin({ template: './src/index.html' }),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   new MiniCssExtractPlugin({
</span><span class="token prefix inserted">+</span><span class="token line">      filename: '[name].css'
</span><span class="token prefix inserted">+</span><span class="token line">   })
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ]
</span></span>};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="_2-指定图片和css目录"><a href="#_2-指定图片和css目录" class="header-anchor">#</a> 2 指定图片和CSS目录</h2> <h3 id="_2-1-webpack-config-js"><a href="#_2-1-webpack-config-js" class="header-anchor">#</a> 2.1 webpack.config.js</h3> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code>const path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');
const MiniCssExtractPlugin = require('mini-css-extract-plugin');
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line"> devtool: false,
</span><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: '[name].js',
</span><span class="token prefix unchanged"> </span><span class="token line">   publicPath: '/'
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     { test: /\.txt$/, use: 'raw-loader' },
</span><span class="token prefix unchanged"> </span><span class="token line">     { test: /\.css$/, use: [MiniCssExtractPlugin.loader, 'css-loader'] },
</span><span class="token prefix unchanged"> </span><span class="token line">     { test: /\.less$/, use: [MiniCssExtractPlugin.loader, 'css-loader', 'less-loader'] },
</span><span class="token prefix unchanged"> </span><span class="token line">     { test: /\.scss$/, use: [MiniCssExtractPlugin.loader, 'css-loader', 'sass-loader'] },
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.(jpg|png|gif|bmp|svg)$/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type:'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">       generator:{
</span><span class="token prefix unchanged"> </span><span class="token line">         filename:'images/[hash][ext]'
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">   new HtmlWebpackPlugin({ template: './src/index.html' }),
</span><span class="token prefix unchanged"> </span><span class="token line">   new MiniCssExtractPlugin({
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      filename: 'css/[name].css'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }),
</span><span class="token prefix unchanged"> </span><span class="token line"> ]
</span></span>};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><h2 id="_3-压缩js、css和html"><a href="#_3-压缩js、css和html" class="header-anchor">#</a> 3. 压缩JS、CSS和HTML</h2> <ul><li><a href="https://www.npmjs.com/package/optimize-css-assets-webpack-plugin" target="_blank" rel="noopener noreferrer">optimize-css-assets-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是一个优化和压缩CSS资源的插件</li> <li><a href="https://www.npmjs.com/package/terser-webpack-plugin" target="_blank" rel="noopener noreferrer">terser-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是一个优化和压缩JS资源的插件</li></ul> <p>webpack.config.js</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code>const path = require('path');
const HtmlWebpackPlugin = require('html-webpack-plugin');
const MiniCssExtractPlugin = require('mini-css-extract-plugin');
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const OptimizeCssAssetsWebpackPlugin = require('optimize-css-assets-webpack-plugin');
</span><span class="token prefix inserted">+</span><span class="token line">const TerserPlugin = require('terser-webpack-plugin');
</span></span>
module.exports = {
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  mode: 'none',
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> devtool: false,
</span><span class="token prefix unchanged"> </span><span class="token line"> entry: './src/index.js',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  optimization: {
</span><span class="token prefix inserted">+</span><span class="token line">    minimize: true,
</span><span class="token prefix inserted">+</span><span class="token line">    minimizer: [
</span><span class="token prefix inserted">+</span><span class="token line">      new TerserPlugin(),
</span><span class="token prefix inserted">+</span><span class="token line">    ],
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> output: {
</span><span class="token prefix unchanged"> </span><span class="token line">   path: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   filename: '[name].js',
</span><span class="token prefix unchanged"> </span><span class="token line">   publicPath: '/',
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> devServer: {
</span><span class="token prefix unchanged"> </span><span class="token line">   contentBase: path.resolve(__dirname, 'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   compress: true,
</span><span class="token prefix unchanged"> </span><span class="token line">   port: 8080,
</span><span class="token prefix unchanged"> </span><span class="token line">   open: true,
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.jsx?$/,
</span><span class="token prefix unchanged"> </span><span class="token line">       loader: 'eslint-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">       enforce: 'pre',
</span><span class="token prefix unchanged"> </span><span class="token line">       options: { fix: true },
</span><span class="token prefix unchanged"> </span><span class="token line">       exclude: /node_modules/,
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.jsx?$/,
</span><span class="token prefix unchanged"> </span><span class="token line">       use: {
</span><span class="token prefix unchanged"> </span><span class="token line">         loader: 'babel-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">         options: {
</span><span class="token prefix unchanged"> </span><span class="token line">           presets: [[
</span><span class="token prefix unchanged"> </span><span class="token line">             '@babel/preset-env',
</span><span class="token prefix unchanged"> </span><span class="token line">             {
</span><span class="token prefix unchanged"> </span><span class="token line">               useBuiltIns: 'usage'
</span><span class="token prefix unchanged"> </span><span class="token line">               corejs: {
</span><span class="token prefix unchanged"> </span><span class="token line">                 version: 3
</span><span class="token prefix unchanged"> </span><span class="token line">               },
</span><span class="token prefix unchanged"> </span><span class="token line">               targets: {
</span><span class="token prefix unchanged"> </span><span class="token line">                 chrome: '60',
</span><span class="token prefix unchanged"> </span><span class="token line">                 firefox: '60',
</span><span class="token prefix unchanged"> </span><span class="token line">                 ie: '9',
</span><span class="token prefix unchanged"> </span><span class="token line">                 safari: '10',
</span><span class="token prefix unchanged"> </span><span class="token line">                 edge: '17',
</span><span class="token prefix unchanged"> </span><span class="token line">               },
</span><span class="token prefix unchanged"> </span><span class="token line">             },
</span><span class="token prefix unchanged"> </span><span class="token line">           ], '@babel/preset-react'],
</span><span class="token prefix unchanged"> </span><span class="token line">           plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">             ['@babel/plugin-proposal-decorators', { legacy: true }],
</span><span class="token prefix unchanged"> </span><span class="token line">             ['@babel/plugin-proposal-class-properties', { loose: true }],
</span><span class="token prefix unchanged"> </span><span class="token line">           ],
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       },
</span><span class="token prefix unchanged"> </span><span class="token line">       include: path.join(__dirname, 'src'),
</span><span class="token prefix unchanged"> </span><span class="token line">       exclude: /node_modules/,
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     { test: /\.txt$/, use: 'raw-loader' },
</span><span class="token prefix unchanged"> </span><span class="token line">     { test: /\.css$/, use: [MiniCssExtractPlugin.loader, 'css-loader', 'postcss-loader'] },
</span><span class="token prefix unchanged"> </span><span class="token line">     { test: /\.less$/, use: [MiniCssExtractPlugin.loader, 'css-loader', 'postcss-loader', 'less-loader'] },
</span><span class="token prefix unchanged"> </span><span class="token line">     { test: /\.scss$/, use: [MiniCssExtractPlugin.loader, 'css-loader', 'postcss-loader', 'sass-loader'] },
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.(jpg|png|gif|bmp|svg)$/,
</span><span class="token prefix unchanged"> </span><span class="token line">       type:'asset/resource',
</span><span class="token prefix unchanged"> </span><span class="token line">       generator:{
</span><span class="token prefix unchanged"> </span><span class="token line">         filename:'images/[hash][ext]'
</span><span class="token prefix unchanged"> </span><span class="token line">       }
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.html$/,
</span><span class="token prefix unchanged"> </span><span class="token line">       loader: 'html-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">   new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">   template: './src/index.html',
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">     minify: {  
</span><span class="token prefix inserted">+</span><span class="token line">        collapseWhitespace: true,
</span><span class="token prefix inserted">+</span><span class="token line">        removeComments: true
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">     }
</span><span class="token prefix unchanged"> </span><span class="token line">   }),
</span><span class="token prefix unchanged"> </span><span class="token line">   new MiniCssExtractPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">     filename: 'css/[name].css',
</span><span class="token prefix unchanged"> </span><span class="token line">   }),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    new OptimizeCssAssetsWebpackPlugin(),
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ],
</span></span>};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br></div></div><h2 id="_4-purgecss-webpack-plugin"><a href="#_4-purgecss-webpack-plugin" class="header-anchor">#</a> 4. purgecss-webpack-plugin</h2> <ul><li><a href="https://www.npmjs.com/package/purgecss-webpack-plugin" target="_blank" rel="noopener noreferrer">purgecss-webpack-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.npmjs.com/package/mini-css-extract-plugin" target="_blank" rel="noopener noreferrer">mini-css-extract-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.purgecss.com/" target="_blank" rel="noopener noreferrer">purgecss<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>可以去除未使用的 css，一般与 glob、glob-all 配合使用</li> <li>必须和<code>mini-css-extract-plugin</code>配合使用</li> <li><code>paths</code>路径是绝对路径</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>npm i  purgecss<span class="token operator">-</span>webpack<span class="token operator">-</span>plugin mini<span class="token operator">-</span>css<span class="token operator">-</span>extract<span class="token operator">-</span>plugin css<span class="token operator">-</span>loader glob <span class="token operator">-</span><span class="token constant">D</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>webpack.config.js</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code>const path = require(&quot;path&quot;);
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const glob = require(&quot;glob&quot;);
</span><span class="token prefix inserted">+</span><span class="token line">const PurgecssPlugin = require(&quot;purgecss-webpack-plugin&quot;);
</span><span class="token prefix inserted">+</span><span class="token line">const MiniCssExtractPlugin = require('mini-css-extract-plugin');
</span></span>const PATHS = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> src: path.join(__dirname, 'src')
</span></span>}
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> mode: &quot;development&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line"> entry: &quot;./src/index.js&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.js/,
</span><span class="token prefix unchanged"> </span><span class="token line">       include: path.resolve(__dirname, &quot;src&quot;),
</span><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: &quot;babel-loader&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           options: {
</span><span class="token prefix unchanged"> </span><span class="token line">             presets: [&quot;@babel/preset-env&quot;, &quot;@babel/preset-react&quot;],
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      {
</span><span class="token prefix inserted">+</span><span class="token line">        test: /\.css$/,
</span><span class="token prefix inserted">+</span><span class="token line">        include: path.resolve(__dirname, &quot;src&quot;),
</span><span class="token prefix inserted">+</span><span class="token line">        exclude: /node_modules/,
</span><span class="token prefix inserted">+</span><span class="token line">        use: [
</span><span class="token prefix inserted">+</span><span class="token line">          {
</span><span class="token prefix inserted">+</span><span class="token line">            loader: MiniCssExtractPlugin.loader,
</span><span class="token prefix inserted">+</span><span class="token line">          },
</span><span class="token prefix inserted">+</span><span class="token line">          &quot;css-loader&quot;,
</span><span class="token prefix inserted">+</span><span class="token line">        ],
</span><span class="token prefix inserted">+</span><span class="token line">      },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> plugins: [
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    new MiniCssExtractPlugin({
</span><span class="token prefix inserted">+</span><span class="token line">      filename: &quot;[name].css&quot;,
</span><span class="token prefix inserted">+</span><span class="token line">    }),
</span><span class="token prefix inserted">+</span><span class="token line">    new PurgecssPlugin({
</span><span class="token prefix inserted">+</span><span class="token line">      paths: glob.sync(`${PATHS.src}/**/*`,  { nodir: true }),
</span><span class="token prefix inserted">+</span><span class="token line">    })
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> ],
</span></span>};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br></div></div><p>style.css</p> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">#root</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">#logo</span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span>green
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="_5-cdn"><a href="#_5-cdn" class="header-anchor">#</a> 5. CDN</h2> <ul><li><a href="https://www.qiniu.com/" target="_blank" rel="noopener noreferrer">qiniu<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>CDN 又叫内容分发网络，通过把资源部署到世界各地，用户在访问时按照就近原则从离用户最近的服务器获取资源，从而加速资源的获取速度。</li> <li><a href="https://webpack.js.org/guides/public-path/#root" target="_blank" rel="noopener noreferrer">public-path<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://npmmirror.com/package/external-remotes-plugin" target="_blank" rel="noopener noreferrer">external-remotes-plugin<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><img src="https://xj-1253772569.file.myqcloud.com/img/cdn2.jpg" alt="cdn"></p> <h3 id="_5-1-使用缓存"><a href="#_5-1-使用缓存" class="header-anchor">#</a> 5.1 使用缓存</h3> <ul><li>HTML文件不缓存，放在自己的服务器上，关闭自己服务器的缓存，静态资源的URL变成指向CDN服务器的地址</li> <li>静态的JavaScript、CSS、图片等文件开启CDN和缓存，并且文件名带上HASH值</li> <li>为了并行加载不阻塞，把不同的静态资源分配到不同的CDN服务器上</li></ul> <h3 id="_5-2-域名限制"><a href="#_5-2-域名限制" class="header-anchor">#</a> 5.2 域名限制</h3> <ul><li>同一时刻针对同一个域名的资源并行请求是有限制</li> <li>可以把这些静态资源分散到不同的 CDN 服务上去</li> <li>多个域名后会增加域名解析时间</li> <li>可以通过在 HTML HEAD 标签中 加入<code>&lt;link rel=&quot;dns-prefetch&quot; href=&quot;http://img.xujian.site&quot;&gt;</code>去预解析域名，以降低域名解析带来的延迟</li></ul> <h3 id="_5-3-文件指纹"><a href="#_5-3-文件指纹" class="header-anchor">#</a> 5.3 文件指纹</h3> <ul><li>打包后输出的文件名和后缀</li> <li>hash一般是结合CDN缓存来使用，通过webpack构建之后，生成对应文件名自动带上对应的MD5值。如果文件内容改变的话，那么对应文件哈希值也会改变，对应的HTML引用的URL地址也会改变，触发CDN服务器从源服务器上拉取对应数据，进而更新本地缓存。</li></ul> <p>指纹占位符</p> <table><thead><tr><th style="text-align:left;">占位符名称</th> <th style="text-align:left;">含义</th></tr></thead> <tbody><tr><td style="text-align:left;">ext</td> <td style="text-align:left;">资源后缀名</td></tr> <tr><td style="text-align:left;">name</td> <td style="text-align:left;">文件名称</td></tr> <tr><td style="text-align:left;">path</td> <td style="text-align:left;">文件的相对路径</td></tr> <tr><td style="text-align:left;">folder</td> <td style="text-align:left;">文件所在的文件夹</td></tr> <tr><td style="text-align:left;">hash</td> <td style="text-align:left;">每次webpack构建时生成一个唯一的hash值</td></tr> <tr><td style="text-align:left;">chunkhash</td> <td style="text-align:left;">根据chunk生成hash值，来源于同一个chunk，则hash值就一样</td></tr> <tr><td style="text-align:left;">contenthash</td> <td style="text-align:left;">根据内容生成hash值，文件内容相同hash值就相同</td></tr></tbody></table> <h4 id="_5-3-1-hash"><a href="#_5-3-1-hash" class="header-anchor">#</a> 5.3.1 hash</h4> <ul><li>Hash 是整个项目的hash值，其根据每次编译内容计算得到，每次编译之后都会生成新的hash,即修改任何文件都会导致所有文件的hash发生改变</li></ul> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code>const path = require(&quot;path&quot;);
const glob = require(&quot;glob&quot;);
const PurgecssPlugin = require(&quot;purgecss-webpack-plugin&quot;);
const MiniCssExtractPlugin = require('mini-css-extract-plugin');
const PATHS = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> src: path.join(__dirname, 'src')
</span></span>}
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> mode: &quot;production&quot;,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">  entry: {
</span><span class="token prefix inserted">+</span><span class="token line">    main: './src/index.js',
</span><span class="token prefix inserted">+</span><span class="token line">    vender:['lodash']
</span><span class="token prefix inserted">+</span><span class="token line">  },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> output:{
</span><span class="token prefix unchanged"> </span><span class="token line">   path:path.resolve(__dirname,'dist'),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    filename:'[name].[hash].js'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> devServer:{
</span><span class="token prefix unchanged"> </span><span class="token line">   hot:false
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.js/,
</span><span class="token prefix unchanged"> </span><span class="token line">       include: path.resolve(__dirname, &quot;src&quot;),
</span><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader:'thread-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">           options:{
</span><span class="token prefix unchanged"> </span><span class="token line">             workers:3
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: &quot;babel-loader&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           options: {
</span><span class="token prefix unchanged"> </span><span class="token line">             presets: [&quot;@babel/preset-env&quot;, &quot;@babel/preset-react&quot;],
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.css$/,
</span><span class="token prefix unchanged"> </span><span class="token line">       include: path.resolve(__dirname, &quot;src&quot;),
</span><span class="token prefix unchanged"> </span><span class="token line">       exclude: /node_modules/,
</span><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: MiniCssExtractPlugin.loader,
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         &quot;css-loader&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">   new MiniCssExtractPlugin({
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      filename: &quot;[name].[hash].css&quot;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }),
</span><span class="token prefix unchanged"> </span><span class="token line">   new PurgecssPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">     paths: glob.sync(`${PATHS.src}/**/*`,  { nodir: true }),
</span><span class="token prefix unchanged"> </span><span class="token line">   }),
</span><span class="token prefix unchanged"> </span><span class="token line"> ],
</span></span>};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><h4 id="_5-3-2-chunkhash"><a href="#_5-3-2-chunkhash" class="header-anchor">#</a> 5.3.2 chunkhash</h4> <ul><li>chunkhash 采用hash计算的话，每一次构建后生成的哈希值都不一样，即使文件内容压根没有改变。这样子是没办法实现缓存效果，我们需要换另一种哈希值计算方式，即chunkhash,chunkhash和hash不一样，它根据不同的入口文件(Entry)进行依赖文件解析、构建对应的chunk，生成对应的哈希值。我们在生产环境里把一些公共库和程序入口文件区分开，单独打包构建，接着我们采用chunkhash的方式生成哈希值，那么只要我们不改动公共库的代码，就可以保证其哈希值不会受影响</li></ul> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code>const path = require(&quot;path&quot;);
const glob = require(&quot;glob&quot;);
const PurgecssPlugin = require(&quot;purgecss-webpack-plugin&quot;);
const MiniCssExtractPlugin = require('mini-css-extract-plugin');
const PATHS = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> src: path.join(__dirname, 'src')
</span></span>}
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> mode: &quot;production&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line"> entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">   main: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   vender:['lodash']
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> output:{
</span><span class="token prefix unchanged"> </span><span class="token line">   path:path.resolve(__dirname,'dist'),
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    filename:'[name].[chunkhash].js'
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> devServer:{
</span><span class="token prefix unchanged"> </span><span class="token line">   hot:false
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.js/,
</span><span class="token prefix unchanged"> </span><span class="token line">       include: path.resolve(__dirname, &quot;src&quot;),
</span><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader:'thread-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">           options:{
</span><span class="token prefix unchanged"> </span><span class="token line">             workers:3
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: &quot;babel-loader&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           options: {
</span><span class="token prefix unchanged"> </span><span class="token line">             presets: [&quot;@babel/preset-env&quot;, &quot;@babel/preset-react&quot;],
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.css$/,
</span><span class="token prefix unchanged"> </span><span class="token line">       include: path.resolve(__dirname, &quot;src&quot;),
</span><span class="token prefix unchanged"> </span><span class="token line">       exclude: /node_modules/,
</span><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: MiniCssExtractPlugin.loader,
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         &quot;css-loader&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">   new MiniCssExtractPlugin({
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      filename: &quot;[name].[chunkhash].css&quot;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }),
</span><span class="token prefix unchanged"> </span><span class="token line">   new PurgecssPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">     paths: glob.sync(`${PATHS.src}/**/*`,  { nodir: true }),
</span><span class="token prefix unchanged"> </span><span class="token line">   }),
</span><span class="token prefix unchanged"> </span><span class="token line"> ],
</span></span>};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><h4 id="_5-3-3-contenthash"><a href="#_5-3-3-contenthash" class="header-anchor">#</a> 5.3.3 contenthash</h4> <ul><li>使用chunkhash存在一个问题，就是当在一个JS文件中引入CSS文件，编译后它们的hash是相同的，而且只要js文件发生改变 ，关联的css文件hash也会改变,这个时候可以使用<code>mini-css-extract-plugin</code>里的<code>contenthash</code>值，保证即使css文件所处的模块里就算其他文件内容改变，只要css文件内容不变，那么不会重复构建</li></ul> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code>const path = require(&quot;path&quot;);
const glob = require(&quot;glob&quot;);
const PurgecssPlugin = require(&quot;purgecss-webpack-plugin&quot;);
const MiniCssExtractPlugin = require('mini-css-extract-plugin');
const PATHS = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> src: path.join(__dirname, 'src')
</span></span>}
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> mode: &quot;production&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line"> entry: {
</span><span class="token prefix unchanged"> </span><span class="token line">   main: './src/index.js',
</span><span class="token prefix unchanged"> </span><span class="token line">   vender:['lodash']
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> output:{
</span><span class="token prefix unchanged"> </span><span class="token line">   path:path.resolve(__dirname,'dist'),
</span><span class="token prefix unchanged"> </span><span class="token line">   filename:'[name].[chunkhash].js'
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> devServer:{
</span><span class="token prefix unchanged"> </span><span class="token line">   hot:false
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> module: {
</span><span class="token prefix unchanged"> </span><span class="token line">   rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.js/,
</span><span class="token prefix unchanged"> </span><span class="token line">       include: path.resolve(__dirname, &quot;src&quot;),
</span><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader:'thread-loader',
</span><span class="token prefix unchanged"> </span><span class="token line">           options:{
</span><span class="token prefix unchanged"> </span><span class="token line">             workers:3
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: &quot;babel-loader&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           options: {
</span><span class="token prefix unchanged"> </span><span class="token line">             presets: [&quot;@babel/preset-env&quot;, &quot;@babel/preset-react&quot;],
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">     {
</span><span class="token prefix unchanged"> </span><span class="token line">       test: /\.css$/,
</span><span class="token prefix unchanged"> </span><span class="token line">       include: path.resolve(__dirname, &quot;src&quot;),
</span><span class="token prefix unchanged"> </span><span class="token line">       exclude: /node_modules/,
</span><span class="token prefix unchanged"> </span><span class="token line">       use: [
</span><span class="token prefix unchanged"> </span><span class="token line">         {
</span><span class="token prefix unchanged"> </span><span class="token line">           loader: MiniCssExtractPlugin.loader,
</span><span class="token prefix unchanged"> </span><span class="token line">         },
</span><span class="token prefix unchanged"> </span><span class="token line">         &quot;css-loader&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">       ],
</span><span class="token prefix unchanged"> </span><span class="token line">     },
</span><span class="token prefix unchanged"> </span><span class="token line">   ],
</span><span class="token prefix unchanged"> </span><span class="token line"> },
</span><span class="token prefix unchanged"> </span><span class="token line"> plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">   new MiniCssExtractPlugin({
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">      filename: &quot;[name].[contenthash].css&quot;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   }),
</span><span class="token prefix unchanged"> </span><span class="token line">   new PurgecssPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">     paths: glob.sync(`${PATHS.src}/**/*`,  { nodir: true }),
</span><span class="token prefix unchanged"> </span><span class="token line">   }),
</span><span class="token prefix unchanged"> </span><span class="token line"> ],
</span></span>};
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br></div></div><h4 id="_5-3-4-hash"><a href="#_5-3-4-hash" class="header-anchor">#</a> 5.3.4 hash</h4> <p><img src="https://xj-1253772569.file.myqcloud.com/variableHash.jpg" alt="variableHash"></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">createHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span>  <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'crypto'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createHash</span><span class="token punctuation">(</span><span class="token string">'md5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> entry <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">entry1</span><span class="token operator">:</span><span class="token string">'entry1'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">entry2</span><span class="token operator">:</span><span class="token string">'entry2'</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> entry1 <span class="token operator">=</span> <span class="token string">'require depModule1'</span><span class="token punctuation">;</span><span class="token comment">//模块entry1</span>
<span class="token keyword">let</span> entry2 <span class="token operator">=</span> <span class="token string">'require depModule2'</span><span class="token punctuation">;</span><span class="token comment">//模块entry2</span>

<span class="token keyword">let</span> depModule1 <span class="token operator">=</span> <span class="token string">'depModule1'</span><span class="token punctuation">;</span><span class="token comment">//模块depModule1</span>
<span class="token keyword">let</span> depModule2 <span class="token operator">=</span> <span class="token string">'depModule2'</span><span class="token punctuation">;</span><span class="token comment">//模块depModule2</span>
<span class="token comment">//如果都使用hash的话，因为这是工程级别的，即每次修改任何一个文件，所有文件名的hash至都将改变。所以一旦修改了任何一个文件，整个项目的文件缓存都将失效</span>
<span class="token keyword">let</span> hash <span class="token operator">=</span>  <span class="token function">createHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>entry1<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>entry2<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>depModule1<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>depModule2<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'hash'</span><span class="token punctuation">,</span>hash<span class="token punctuation">)</span>
<span class="token comment">//chunkhash根据不同的入口文件(Entry)进行依赖文件解析、构建对应的chunk，生成对应的哈希值。</span>
<span class="token comment">//在生产环境里把一些公共库和程序入口文件区分开，单独打包构建，接着我们采用chunkhash的方式生成哈希值，那么只要我们不改动公共库的代码，就可以保证其哈希值不会受影响</span>
<span class="token keyword">let</span> entry1ChunkHash <span class="token operator">=</span> <span class="token function">createHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>entry1<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>depModule1<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'entry1ChunkHash'</span><span class="token punctuation">,</span>entry1ChunkHash<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> entry2ChunkHash <span class="token operator">=</span> <span class="token function">createHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>entry2<span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>depModule2<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'entry2ChunkHash'</span><span class="token punctuation">,</span>entry2ChunkHash<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> entry1File <span class="token operator">=</span> entry1<span class="token operator">+</span>depModule1<span class="token punctuation">;</span>
<span class="token keyword">let</span> entry1ContentHash <span class="token operator">=</span> <span class="token function">createHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>entry1File<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'entry1ContentHash'</span><span class="token punctuation">,</span>entry1ContentHash<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> entry2File <span class="token operator">=</span> entry2<span class="token operator">+</span>depModule2<span class="token punctuation">;</span>
<span class="token keyword">let</span> entry2ContentHash <span class="token operator">=</span> <span class="token function">createHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>entry2File<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">digest</span><span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'entry2ContentHash'</span><span class="token punctuation">,</span>entry2ContentHash<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><h3 id="_5-4-hashplugin"><a href="#_5-4-hashplugin" class="header-anchor">#</a> 5.4.HashPlugin</h3> <ul><li>可以自己修改各种hash值</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">HashPlugin</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>options <span class="token operator">=</span> options<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>compilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'HashPlugin'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span>params</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token comment">//如果你想改变hash值，可以在hash生成这后修改</span>
            compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>afterHash<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">'HashPlugin'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
                <span class="token keyword">let</span> fullhash <span class="token operator">=</span> <span class="token string">'fullhash'</span><span class="token punctuation">;</span><span class="token comment">//时间戳</span>
                console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'本次编译的compilation.hash'</span><span class="token punctuation">,</span>compilation<span class="token punctuation">.</span>hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
                compilation<span class="token punctuation">.</span>hash<span class="token operator">=</span> fullhash<span class="token punctuation">;</span><span class="token comment">//output.filename [fullhash]</span>
                <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> chunk <span class="token keyword">of</span> compilation<span class="token punctuation">.</span>chunks<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'chunk.hash'</span><span class="token punctuation">,</span>chunk<span class="token punctuation">.</span>hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    chunk<span class="token punctuation">.</span>renderedHash <span class="token operator">=</span> <span class="token string">'chunkHash'</span><span class="token punctuation">;</span><span class="token comment">//可以改变chunkhash</span>
                    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'chunk.contentHash'</span><span class="token punctuation">,</span>chunk<span class="token punctuation">.</span>contentHash<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    chunk<span class="token punctuation">.</span>contentHash<span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">javascript</span><span class="token operator">:</span> <span class="token string">'javascriptContentHash'</span><span class="token punctuation">,</span><span class="token string-property property">'css/mini-extract'</span><span class="token operator">:</span><span class="token string">'cssContentHash'</span> <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> HashPlugin<span class="token punctuation">;</span>
<span class="token comment">/**
 * 三种hash
 * 1. hash compilation.hash 
 * 2. chunkHash 每个chunk都会有一个hash
 * 3. contentHash 内容hash 每个文件会可能有一个hash值
 */</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>webpack.config.js</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code>const path = require('path');
const DonePlugin = require('./plugins/DonePlugin');
const AssetPlugin = require('./plugins/AssetPlugin');
const ZipPlugin = require('./plugins/ZipPlugin');
const HashPlugin = require('./plugins/HashPlugin');
const AutoExternalPlugin = require('./plugins/AutoExternalPlugin');
const MiniCssExtractPlugin = require('mini-css-extract-plugin');
const HtmlWebpackPlugin = require('html-webpack-plugin');
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   module: {
</span><span class="token prefix unchanged"> </span><span class="token line">       rules: [
</span><span class="token prefix unchanged"> </span><span class="token line">           {
</span><span class="token prefix unchanged"> </span><span class="token line">               test: /\.css$/,
</span><span class="token prefix unchanged"> </span><span class="token line">               use: [
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">                   MiniCssExtractPlugin.loader,
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">                   'css-loader'
</span><span class="token prefix unchanged"> </span><span class="token line">               ]
</span><span class="token prefix unchanged"> </span><span class="token line">           }
</span><span class="token prefix unchanged"> </span><span class="token line">       ]
</span><span class="token prefix unchanged"> </span><span class="token line">   },
</span><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">       new HashPlugin(),
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   ]
</span></span>}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="_6-moduleids-chunkids的优化"><a href="#_6-moduleids-chunkids的优化" class="header-anchor">#</a> 6.moduleIds &amp; chunkIds的优化</h2> <h3 id="_6-1-概念和选项"><a href="#_6-1-概念和选项" class="header-anchor">#</a> 6.1 概念和选项</h3> <ul><li>module: 每一个文件其实都可以看成一个 module</li> <li>chunk: webpack打包最终生成的代码块，代码块会生成文件，一个文件对应一个chunk</li> <li>在webpack5之前，没有从entry打包的chunk文件，都会以1、2、3...的文件命名方式输出,删除某些些文件可能会导致缓存失效</li> <li>在生产模式下，默认启用这些功能chunkIds: &quot;deterministic&quot;, moduleIds: &quot;deterministic&quot;，此算法采用<code>确定性</code>的方式将短数字 ID(3 或 4 个字符)短hash值分配给 modules 和 chunks</li> <li>chunkId设置为deterministic，则output中chunkFilename里的[name]会被替换成确定性短数字ID</li> <li>虽然chunkId不变(不管值是deterministic | natural | named)，但更改chunk内容，chunkhash还是会改变的</li></ul> <table><thead><tr><th style="text-align:left;">可选值</th> <th style="text-align:left;">含义</th> <th style="text-align:left;">示例</th></tr></thead> <tbody><tr><td style="text-align:left;">natural</td> <td style="text-align:left;">按使用顺序的数字ID</td> <td style="text-align:left;">1</td></tr> <tr><td style="text-align:left;">named</td> <td style="text-align:left;">方便调试的高可读性id</td> <td style="text-align:left;">src_two_js.js</td></tr> <tr><td style="text-align:left;">deterministic</td> <td style="text-align:left;">根据模块名称生成简短的hash值</td> <td style="text-align:left;">915</td></tr> <tr><td style="text-align:left;">size</td> <td style="text-align:left;">根据模块大小生成的数字id</td> <td style="text-align:left;">0</td></tr></tbody></table> <h3 id="_6-2-webpack-config-js"><a href="#_6-2-webpack-config-js" class="header-anchor">#</a> 6.2 webpack.config.js</h3> <p>webpack.config.js</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code>const path = require('path');
module.exports = {
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   mode: 'development',
</span><span class="token prefix unchanged"> </span><span class="token line">   devtool:false,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">   optimization:{
</span><span class="token prefix inserted">+</span><span class="token line">       moduleIds:'deterministic',
</span><span class="token prefix inserted">+</span><span class="token line">       chunkIds:'deterministic'
</span><span class="token prefix inserted">+</span><span class="token line">   }
</span></span>}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_6-3-src-index-js"><a href="#_6-3-src-index-js" class="header-anchor">#</a> 6.3 src\index.js</h3> <p>src\index.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./one'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./two'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./three'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="_7-模块联邦"><a href="#_7-模块联邦" class="header-anchor">#</a> 7.模块联邦</h2> <h3 id="_7-1-动机"><a href="#_7-1-动机" class="header-anchor">#</a> 7.1.动机</h3> <ul><li>Module Federation的动机是为了不同开发小组间共同开发一个或者多个应用</li> <li>应用将被划分为更小的应用块，一个应用块，可以是比如头部导航或者侧边栏的前端组件，也可以是数据获取逻辑的逻辑组件</li> <li>每个应用块由不同的组开发</li> <li>应用或应用块共享其他其他应用块或者库</li></ul> <p><img src="https://xj-1253772569.file.myqcloud.com/1608392171072" alt="1608392171072"></p> <h3 id="_7-2-module-federation"><a href="#_7-2-module-federation" class="header-anchor">#</a> 7.2.Module Federation</h3> <ul><li>使用Module Federation时，每个应用块都是一个独立的构建，这些构建都将编译为容器</li> <li>容器可以被其他应用或者其他容器应用</li> <li>一个被引用的容器被称为<code>remote</code>, 引用者被称为<code>host</code>，<code>remote</code>暴露模块给<code>host</code>, <code>host</code>则可以使用这些暴露的模块，这些模块被成为<code>remote</code>模块</li></ul> <p><img src="https://xj-1253772569.file.myqcloud.com/1608722799323" alt="1608722799323"></p> <h3 id="_7-3-实战"><a href="#_7-3-实战" class="header-anchor">#</a> 7.3.实战</h3> <h4 id="_7-3-1-配置参数"><a href="#_7-3-1-配置参数" class="header-anchor">#</a> 7.3.1 配置参数</h4> <table><thead><tr><th style="text-align:left;">字段</th> <th style="text-align:left;">类型</th> <th style="text-align:left;">含义</th></tr></thead> <tbody><tr><td style="text-align:left;">name</td> <td style="text-align:left;">string</td> <td style="text-align:left;">必传值，即输出的模块名，被远程引用时路径为${name}/${expose}</td></tr> <tr><td style="text-align:left;">library</td> <td style="text-align:left;">object</td> <td style="text-align:left;">声明全局变量的方式，name为umd的name</td></tr> <tr><td style="text-align:left;">filename</td> <td style="text-align:left;">string</td> <td style="text-align:left;">构建输出的文件名</td></tr> <tr><td style="text-align:left;">remotes</td> <td style="text-align:left;">object</td> <td style="text-align:left;">远程引用的应用名及其别名的映射，使用时以key值作为name</td></tr> <tr><td style="text-align:left;">exposes</td> <td style="text-align:left;">object</td> <td style="text-align:left;">被远程引用时可暴露的资源路径及其别名</td></tr> <tr><td style="text-align:left;">shared</td> <td style="text-align:left;">object</td> <td style="text-align:left;">与其他应用之间可以共享的第三方依赖，使你的代码中不用重复加载同一份依赖</td></tr></tbody></table> <h4 id="_7-3-2-remote"><a href="#_7-3-2-remote" class="header-anchor">#</a> 7.3.2 remote</h4> <h5 id="_7-3-2-1-remote-webpack-config-js"><a href="#_7-3-2-1-remote-webpack-config-js" class="header-anchor">#</a> 7.3.2.1 remote\webpack.config.js</h5> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ModuleFederationPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack/lib/container/ModuleFederationPlugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:3000/&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">3000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-react&quot;</span><span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'./public/index.html'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;remoteEntry.js&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;remote&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">exposes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;./NewsList&quot;</span><span class="token operator">:</span> <span class="token string">&quot;./src/NewsList&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h5 id="_7-3-2-2-remote-src-index-js"><a href="#_7-3-2-2-remote-src-index-js" class="header-anchor">#</a> 7.3.2.2 remote\src\index.js</h5> <p>remote\src\index.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./bootstrap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="_7-3-2-3-remote-src-bootstrap-js"><a href="#_7-3-2-3-remote-src-bootstrap-js" class="header-anchor">#</a> 7.3.2.3 remote\src\bootstrap.js</h5> <p>remote\src\bootstrap.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&quot;./App&quot;</span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="_7-3-2-4-remote-src-app-js"><a href="#_7-3-2-4-remote-src-app-js" class="header-anchor">#</a> 7.3.2.4 remote\src\App.js</h5> <p>remote\src\App.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> NewsList <span class="token keyword">from</span> <span class="token string">'./NewsList'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>本地组件NewsList<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>NewsList <span class="token operator">/</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="_7-3-2-5-remote-src-newslist-js"><a href="#_7-3-2-5-remote-src-newslist-js" class="header-anchor">#</a> 7.3.2.5 remote\src\NewsList.js</h5> <p>remote\src\NewsList.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>新闻列表<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_7-3-3-host"><a href="#_7-3-3-host" class="header-anchor">#</a> 7.3.3 host</h4> <h5 id="_7-3-3-1-host-webpack-config-js"><a href="#_7-3-3-1-host-webpack-config-js" class="header-anchor">#</a> 7.3.3.1 host\webpack.config.js</h5> <p>host\webpack.config.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ModuleFederationPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack/lib/container/ModuleFederationPlugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:8000/&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">8000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-react&quot;</span><span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">template</span><span class="token operator">:</span> <span class="token string">'./public/index.html'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;remoteEntry.js&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;host&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">remotes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">remote</span><span class="token operator">:</span> <span class="token string">&quot;remote@http://localhost:3000/remoteEntry.js&quot;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h5 id="_7-3-3-2-host-src-index-js"><a href="#_7-3-3-2-host-src-index-js" class="header-anchor">#</a> 7.3.3.2 host\src\index.js</h5> <p>host\src\index.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./bootstrap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="_7-3-3-3-host-src-bootstrap-js"><a href="#_7-3-3-3-host-src-bootstrap-js" class="header-anchor">#</a> 7.3.3.3 host\src\bootstrap.js</h5> <p>host\src\bootstrap.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&quot;./App&quot;</span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="_7-3-3-4-host-src-app-js"><a href="#_7-3-3-4-host-src-app-js" class="header-anchor">#</a> 7.3.3.4 host\src\App.js</h5> <p>host\src\App.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Slides <span class="token keyword">from</span> <span class="token string">'./Slides'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> RemoteNewsList <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;remote/NewsList&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h2 <span class="token operator">&gt;</span>本地组件Slides<span class="token punctuation">,</span> 远程组件NewsList<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Slides <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Suspense fallback<span class="token operator">=</span><span class="token string">&quot;Loading NewsList&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>RemoteNewsList <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Suspense<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="_7-3-3-5-host-src-slides-js"><a href="#_7-3-3-5-host-src-slides-js" class="header-anchor">#</a> 7.3.3.5 host\src\Slides.js</h5> <p>host\src\Slides.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>轮播图<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_7-4-shared"><a href="#_7-4-shared" class="header-anchor">#</a> 7.4.shared</h3> <ul><li><code>shared</code>配置主要是用来避免项目出现多个公共依赖</li></ul> <p><img src="https://xj-1253772569.file.myqcloud.com/1608851802459_1637746243640.jpg" alt="1608851802459"></p> <h4 id="_7-4-1-remote-webpack-config-js"><a href="#_7-4-1-remote-webpack-config-js" class="header-anchor">#</a> 7.4.1 remote\webpack.config.js</h4> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">       new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">           template:'./public/index.html'
</span><span class="token prefix unchanged"> </span><span class="token line">       }),
</span><span class="token prefix unchanged"> </span><span class="token line">       new ModuleFederationPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">           filename: &quot;remoteEntry.js&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           name: &quot;remote&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           exposes: {
</span><span class="token prefix unchanged"> </span><span class="token line">               &quot;./NewsList&quot;: &quot;./src/NewsList&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            shared:{
</span><span class="token prefix inserted">+</span><span class="token line">                react: { singleton: true },
</span><span class="token prefix inserted">+</span><span class="token line">                &quot;react-dom&quot;: { singleton: true }
</span><span class="token prefix inserted">+</span><span class="token line">              }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">         })
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="_7-4-2-host-webpack-config-js"><a href="#_7-4-2-host-webpack-config-js" class="header-anchor">#</a> 7.4.2 host\webpack.config.js</h4> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">       new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">           template: './public/index.html'
</span><span class="token prefix unchanged"> </span><span class="token line">       }),
</span><span class="token prefix unchanged"> </span><span class="token line">       new ModuleFederationPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">           filename: &quot;remoteEntry.js&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           name: &quot;host&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           remotes: {
</span><span class="token prefix unchanged"> </span><span class="token line">               remote: &quot;remote@http://localhost:3000/remoteEntry.js&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">           shared:{
</span><span class="token prefix inserted">+</span><span class="token line">                react: { singleton: true },
</span><span class="token prefix inserted">+</span><span class="token line">                &quot;react-dom&quot;: { singleton: true }
</span><span class="token prefix inserted">+</span><span class="token line">           }
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="_7-5-双向依赖"><a href="#_7-5-双向依赖" class="header-anchor">#</a> 7.5.双向依赖</h3> <ul><li>Module Federation 的共享可以是双向的</li></ul> <h4 id="_7-5-1-remote-webpack-config-js"><a href="#_7-5-1-remote-webpack-config-js" class="header-anchor">#</a> 7.5.1 remote\webpack.config.js</h4> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">       new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">           template:'./public/index.html'
</span><span class="token prefix unchanged"> </span><span class="token line">       }),
</span><span class="token prefix unchanged"> </span><span class="token line">       new ModuleFederationPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">           filename: &quot;remoteEntry.js&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           name: &quot;remote&quot;,
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">            remotes: {
</span><span class="token prefix inserted">+</span><span class="token line">                host: &quot;host@http://localhost:8000/remoteEntry.js&quot;
</span><span class="token prefix inserted">+</span><span class="token line">            },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           exposes: {
</span><span class="token prefix unchanged"> </span><span class="token line">               &quot;./NewsList&quot;: &quot;./src/NewsList&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span><span class="token prefix unchanged"> </span><span class="token line">           shared:{
</span><span class="token prefix unchanged"> </span><span class="token line">               react: { singleton: true },
</span><span class="token prefix unchanged"> </span><span class="token line">               &quot;react-dom&quot;: { singleton: true }
</span><span class="token prefix unchanged"> </span><span class="token line">             }
</span><span class="token prefix unchanged"> </span><span class="token line">         })
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="_7-5-2-host-webpack-config-js"><a href="#_7-5-2-host-webpack-config-js" class="header-anchor">#</a> 7.5.2 host\webpack.config.js</h4> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   plugins: [
</span><span class="token prefix unchanged"> </span><span class="token line">       new HtmlWebpackPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">           template: './public/index.html'
</span><span class="token prefix unchanged"> </span><span class="token line">       }),
</span><span class="token prefix unchanged"> </span><span class="token line">       new ModuleFederationPlugin({
</span><span class="token prefix unchanged"> </span><span class="token line">           filename: &quot;remoteEntry.js&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           name: &quot;host&quot;,
</span><span class="token prefix unchanged"> </span><span class="token line">           remotes: {
</span><span class="token prefix unchanged"> </span><span class="token line">               remote: &quot;remote@http://localhost:3000/remoteEntry.js&quot;
</span><span class="token prefix unchanged"> </span><span class="token line">           },
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">           exposes: {
</span><span class="token prefix inserted">+</span><span class="token line">                &quot;./Slides&quot;: &quot;./src/Slides&quot;,
</span><span class="token prefix inserted">+</span><span class="token line">           },
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">           shared:{
</span><span class="token prefix unchanged"> </span><span class="token line">               react: { singleton: true },
</span><span class="token prefix unchanged"> </span><span class="token line">               &quot;react-dom&quot;: { singleton: true }
</span><span class="token prefix unchanged"> </span><span class="token line">             }
</span><span class="token prefix unchanged"> </span><span class="token line">       })
</span><span class="token prefix unchanged"> </span><span class="token line">   ]
</span></span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="_7-5-3-remote-src-app-js"><a href="#_7-5-3-remote-src-app-js" class="header-anchor">#</a> 7.5.3 remote\src\App.js</h4> <p>remote\src\App.js</p> <div class="language-diff line-numbers-mode"><pre class="language-diff"><code>import React from &quot;react&quot;;
import NewsList from './NewsList';
<span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">const RemoteSlides = React.lazy(() =&gt; import(&quot;host/Slides&quot;));
</span></span>const App = () =&gt; (
<span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;div&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;h2&gt;本地组件NewsList,远程组件Slides&lt;/h2&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line">   &lt;NewsList /&gt;
</span></span><span class="token inserted-sign inserted"><span class="token prefix inserted">+</span><span class="token line">    &lt;React.Suspense fallback=&quot;Loading Slides&quot;&gt;
</span><span class="token prefix inserted">+</span><span class="token line">      &lt;RemoteSlides /&gt;
</span><span class="token prefix inserted">+</span><span class="token line">    &lt;/React.Suspense&gt;
</span></span><span class="token unchanged"><span class="token prefix unchanged"> </span><span class="token line"> &lt;/div&gt;
</span></span>);

export default App;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_7-6-多个remote"><a href="#_7-6-多个remote" class="header-anchor">#</a> 7.6.多个remote</h3> <h4 id="_7-6-1-all-webpack-config-js"><a href="#_7-6-1-all-webpack-config-js" class="header-anchor">#</a> 7.6.1 all\webpack.config.js</h4> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;path&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> webpack <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;html-webpack-plugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ModuleFederationPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&quot;webpack/lib/container/ModuleFederationPlugin&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;development&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">entry</span><span class="token operator">:</span> <span class="token string">&quot;./src/index.js&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">publicPath</span><span class="token operator">:</span> <span class="token string">&quot;http://localhost:3000/&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">devServer</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">port</span><span class="token operator">:</span> <span class="token number">5000</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">module</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
                <span class="token literal-property property">test</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\.jsx?$</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
                <span class="token literal-property property">use</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                    <span class="token literal-property property">loader</span><span class="token operator">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">options</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token literal-property property">presets</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-react&quot;</span><span class="token punctuation">]</span>
                    <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token literal-property property">exclude</span><span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">node_modules</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">template</span><span class="token operator">:</span><span class="token string">'./public/index.html'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token keyword">new</span> <span class="token class-name">ModuleFederationPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">&quot;remoteEntry.js&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;all&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">remotes</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token literal-property property">remote</span><span class="token operator">:</span> <span class="token string">&quot;remote@http://localhost:3000/remoteEntry.js&quot;</span><span class="token punctuation">,</span>
                <span class="token literal-property property">host</span><span class="token operator">:</span> <span class="token string">&quot;host@http://localhost:8000/remoteEntry.js&quot;</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">shared</span><span class="token operator">:</span><span class="token punctuation">{</span>
                <span class="token literal-property property">react</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">singleton</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;react-dom&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">singleton</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><h4 id="_7-6-2-remote-src-index-js"><a href="#_7-6-2-remote-src-index-js" class="header-anchor">#</a> 7.6.2 remote\src\index.js</h4> <p>remote\src\index.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;./bootstrap&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_7-6-3-remote-src-bootstrap-js"><a href="#_7-6-3-remote-src-bootstrap-js" class="header-anchor">#</a> 7.6.3 remote\src\bootstrap.js</h4> <p>remote\src\bootstrap.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">&quot;react-dom&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">&quot;./App&quot;</span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;root&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_7-6-4-remote-src-app-js"><a href="#_7-6-4-remote-src-app-js" class="header-anchor">#</a> 7.6.4 remote\src\App.js</h4> <p>remote\src\App.js</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> RemoteSlides <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;host/Slides&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> RemoteNewsList <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">&quot;remote/NewsList&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token function-variable function">App</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>远程组件Slides<span class="token punctuation">,</span>远程组件NewsList<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Suspense fallback<span class="token operator">=</span><span class="token string">&quot;Loading Slides&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>RemoteSlides <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Suspense<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Suspense fallback<span class="token operator">=</span><span class="token string">&quot;Loading NewsList&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>RemoteNewsList <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Suspense<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com//sunnyxujian/edit/master/docs/03.工程化/04.webpack/19.打包优化之loader&amp;plugin.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/05/23, 15:08:15</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/dfb427/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">打包优化之config</div></a> <a href="/engineering/rollup/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">rollup基础用法</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/dfb427/" class="prev">打包优化之config</a></span> <span class="next"><a href="/engineering/rollup/">rollup基础用法</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/de22dd/"><div>😍Vue3和React都在用的函数式编程，学起来~</div></a> <span>02-03</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/29bc3b/"><div>链表</div></a> <span>11-24</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/7f20fa/"><div>基础类型</div></a> <span>11-18</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1227971544@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/sunnyxujian" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a>Vdoing</a> 
    | Copyright © 2020-2023
    <span>xujian | <a href="https://gitee.com/microjan/blog/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div><div class="cat-container" data-v-a13867c0><canvas id="vuepress-cat" width="280" height="250" class="live2d" data-v-a13867c0></canvas></div><!----><div class="RibbonAnimation"></div></div></div>
    <script src="/assets/js/app.d76a6140.js" defer></script><script src="/assets/js/3.724bf448.js" defer></script><script src="/assets/js/5.f79ce4cb.js" defer></script><script src="/assets/js/81.3ca1bc6d.js" defer></script>
  </body>
</html>