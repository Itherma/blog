<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Mini React 之声明式渲染框架 | sunnyxujian&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.0">
    <link rel="icon" href="/img/favicon1.ico">
    <meta name="description" content="web前端技术博客,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,react,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#4fc08d">
    <link rel="preload" href="/assets/css/0.styles.280b48f2.css" as="style"><link rel="preload" href="/assets/js/app.d76a6140.js" as="script"><link rel="preload" href="/assets/js/3.724bf448.js" as="script"><link rel="preload" href="/assets/js/5.f79ce4cb.js" as="script"><link rel="preload" href="/assets/js/61.ae4b86ed.js" as="script"><link rel="prefetch" href="/assets/js/10.33e63f5b.js"><link rel="prefetch" href="/assets/js/100.88170c76.js"><link rel="prefetch" href="/assets/js/101.8d54c91e.js"><link rel="prefetch" href="/assets/js/102.7dff272c.js"><link rel="prefetch" href="/assets/js/103.b5f8461b.js"><link rel="prefetch" href="/assets/js/104.a6516759.js"><link rel="prefetch" href="/assets/js/105.ad5b08fd.js"><link rel="prefetch" href="/assets/js/106.157581cd.js"><link rel="prefetch" href="/assets/js/107.68e05ec4.js"><link rel="prefetch" href="/assets/js/108.76688ddd.js"><link rel="prefetch" href="/assets/js/109.73504a9d.js"><link rel="prefetch" href="/assets/js/11.0de4544b.js"><link rel="prefetch" href="/assets/js/110.289cecf3.js"><link rel="prefetch" href="/assets/js/111.2229d3c3.js"><link rel="prefetch" href="/assets/js/112.b63d71e6.js"><link rel="prefetch" href="/assets/js/113.1b781191.js"><link rel="prefetch" href="/assets/js/114.8d59c3f9.js"><link rel="prefetch" href="/assets/js/115.8e3070e3.js"><link rel="prefetch" href="/assets/js/116.e94d9ee8.js"><link rel="prefetch" href="/assets/js/117.e1ebdb1a.js"><link rel="prefetch" href="/assets/js/118.92597187.js"><link rel="prefetch" href="/assets/js/119.02881f9b.js"><link rel="prefetch" href="/assets/js/12.056774d7.js"><link rel="prefetch" href="/assets/js/120.f7f95b51.js"><link rel="prefetch" href="/assets/js/121.d87b90ad.js"><link rel="prefetch" href="/assets/js/122.8e81d12f.js"><link rel="prefetch" href="/assets/js/123.d1c5d272.js"><link rel="prefetch" href="/assets/js/124.071d3876.js"><link rel="prefetch" href="/assets/js/125.8da325b6.js"><link rel="prefetch" href="/assets/js/126.f3fac94a.js"><link rel="prefetch" href="/assets/js/127.705b0231.js"><link rel="prefetch" href="/assets/js/128.2d0cce43.js"><link rel="prefetch" href="/assets/js/129.136c9093.js"><link rel="prefetch" href="/assets/js/13.c41460b7.js"><link rel="prefetch" href="/assets/js/130.e273b0cd.js"><link rel="prefetch" href="/assets/js/131.1cdc1f03.js"><link rel="prefetch" href="/assets/js/132.e825fb82.js"><link rel="prefetch" href="/assets/js/133.0d293ef7.js"><link rel="prefetch" href="/assets/js/134.a0d635b9.js"><link rel="prefetch" href="/assets/js/135.1af5e654.js"><link rel="prefetch" href="/assets/js/136.bd4c2e25.js"><link rel="prefetch" href="/assets/js/137.e7d9d057.js"><link rel="prefetch" href="/assets/js/138.b2c4087c.js"><link rel="prefetch" href="/assets/js/139.9d81cea3.js"><link rel="prefetch" href="/assets/js/14.6f0de051.js"><link rel="prefetch" href="/assets/js/140.462f2f68.js"><link rel="prefetch" href="/assets/js/141.bfd924b2.js"><link rel="prefetch" href="/assets/js/142.f02c9f6c.js"><link rel="prefetch" href="/assets/js/143.3f153586.js"><link rel="prefetch" href="/assets/js/144.bba01f15.js"><link rel="prefetch" href="/assets/js/145.e6a25735.js"><link rel="prefetch" href="/assets/js/146.cd93e9ca.js"><link rel="prefetch" href="/assets/js/147.63f46f4b.js"><link rel="prefetch" href="/assets/js/148.138380f5.js"><link rel="prefetch" href="/assets/js/149.3980b184.js"><link rel="prefetch" href="/assets/js/15.60153c2f.js"><link rel="prefetch" href="/assets/js/150.7e8cb34a.js"><link rel="prefetch" href="/assets/js/151.559be224.js"><link rel="prefetch" href="/assets/js/152.a51c57fb.js"><link rel="prefetch" href="/assets/js/153.887a69dd.js"><link rel="prefetch" href="/assets/js/154.76aed2e7.js"><link rel="prefetch" href="/assets/js/155.5843b58d.js"><link rel="prefetch" href="/assets/js/156.9b68b27b.js"><link rel="prefetch" href="/assets/js/157.c79c5fef.js"><link rel="prefetch" href="/assets/js/158.3e7d2e05.js"><link rel="prefetch" href="/assets/js/159.ed6b9d8b.js"><link rel="prefetch" href="/assets/js/16.82dd19ed.js"><link rel="prefetch" href="/assets/js/160.37259815.js"><link rel="prefetch" href="/assets/js/161.7a48a04c.js"><link rel="prefetch" href="/assets/js/162.ffd40c22.js"><link rel="prefetch" href="/assets/js/163.eaf5d0ee.js"><link rel="prefetch" href="/assets/js/164.e5353a66.js"><link rel="prefetch" href="/assets/js/165.fe4a33a5.js"><link rel="prefetch" href="/assets/js/166.eb2a137a.js"><link rel="prefetch" href="/assets/js/167.d209e1d2.js"><link rel="prefetch" href="/assets/js/168.e1d97e56.js"><link rel="prefetch" href="/assets/js/169.c96bc779.js"><link rel="prefetch" href="/assets/js/17.c33de90a.js"><link rel="prefetch" href="/assets/js/170.53428bf5.js"><link rel="prefetch" href="/assets/js/171.685b798b.js"><link rel="prefetch" href="/assets/js/172.8127d652.js"><link rel="prefetch" href="/assets/js/173.f63942d1.js"><link rel="prefetch" href="/assets/js/174.7aaff485.js"><link rel="prefetch" href="/assets/js/175.411e5ac1.js"><link rel="prefetch" href="/assets/js/176.e65c95bb.js"><link rel="prefetch" href="/assets/js/177.90e620f4.js"><link rel="prefetch" href="/assets/js/178.d4ea1cdd.js"><link rel="prefetch" href="/assets/js/179.01df97a3.js"><link rel="prefetch" href="/assets/js/18.456e4218.js"><link rel="prefetch" href="/assets/js/180.0f5cda26.js"><link rel="prefetch" href="/assets/js/181.d3f6c371.js"><link rel="prefetch" href="/assets/js/182.18df4323.js"><link rel="prefetch" href="/assets/js/183.ce19b32c.js"><link rel="prefetch" href="/assets/js/184.780c19d0.js"><link rel="prefetch" href="/assets/js/185.8571a197.js"><link rel="prefetch" href="/assets/js/186.716b43aa.js"><link rel="prefetch" href="/assets/js/187.6acda53b.js"><link rel="prefetch" href="/assets/js/188.9460ea0f.js"><link rel="prefetch" href="/assets/js/189.f69905c1.js"><link rel="prefetch" href="/assets/js/19.1223b684.js"><link rel="prefetch" href="/assets/js/190.d0fb2193.js"><link rel="prefetch" href="/assets/js/191.dd8d7bea.js"><link rel="prefetch" href="/assets/js/192.e7ab2686.js"><link rel="prefetch" href="/assets/js/193.e1aef55c.js"><link rel="prefetch" href="/assets/js/194.790d107b.js"><link rel="prefetch" href="/assets/js/195.ce213cdb.js"><link rel="prefetch" href="/assets/js/196.d8e7ce65.js"><link rel="prefetch" href="/assets/js/197.6ca159ed.js"><link rel="prefetch" href="/assets/js/198.1f9103bf.js"><link rel="prefetch" href="/assets/js/199.647fab7d.js"><link rel="prefetch" href="/assets/js/2.900ae423.js"><link rel="prefetch" href="/assets/js/20.bc706733.js"><link rel="prefetch" href="/assets/js/200.5c297a04.js"><link rel="prefetch" href="/assets/js/201.b860990a.js"><link rel="prefetch" href="/assets/js/202.a2dee90c.js"><link rel="prefetch" href="/assets/js/203.6df560c4.js"><link rel="prefetch" href="/assets/js/204.ba95b5a5.js"><link rel="prefetch" href="/assets/js/205.8878cde9.js"><link rel="prefetch" href="/assets/js/206.cf365d5c.js"><link rel="prefetch" href="/assets/js/207.1265f6f6.js"><link rel="prefetch" href="/assets/js/208.d3292fda.js"><link rel="prefetch" href="/assets/js/209.31ad945b.js"><link rel="prefetch" href="/assets/js/21.d5b15a9e.js"><link rel="prefetch" href="/assets/js/210.d4095a65.js"><link rel="prefetch" href="/assets/js/211.da7e7f0b.js"><link rel="prefetch" href="/assets/js/212.86ffee1c.js"><link rel="prefetch" href="/assets/js/213.fc14f988.js"><link rel="prefetch" href="/assets/js/214.276b3100.js"><link rel="prefetch" href="/assets/js/215.977e7988.js"><link rel="prefetch" href="/assets/js/216.245b5975.js"><link rel="prefetch" href="/assets/js/217.e36d5149.js"><link rel="prefetch" href="/assets/js/218.f7b84d56.js"><link rel="prefetch" href="/assets/js/219.b17c2d18.js"><link rel="prefetch" href="/assets/js/22.305d3e0e.js"><link rel="prefetch" href="/assets/js/220.89978bee.js"><link rel="prefetch" href="/assets/js/221.94e9bc2b.js"><link rel="prefetch" href="/assets/js/222.d509002e.js"><link rel="prefetch" href="/assets/js/223.7d5329ab.js"><link rel="prefetch" href="/assets/js/224.d1efb469.js"><link rel="prefetch" href="/assets/js/225.068d1edc.js"><link rel="prefetch" href="/assets/js/226.203df552.js"><link rel="prefetch" href="/assets/js/227.ee66205e.js"><link rel="prefetch" href="/assets/js/228.611dcfa5.js"><link rel="prefetch" href="/assets/js/229.4570cebd.js"><link rel="prefetch" href="/assets/js/23.93f0d1ba.js"><link rel="prefetch" href="/assets/js/230.479fc52e.js"><link rel="prefetch" href="/assets/js/231.ac2939f8.js"><link rel="prefetch" href="/assets/js/232.1b593957.js"><link rel="prefetch" href="/assets/js/233.ed19c07d.js"><link rel="prefetch" href="/assets/js/234.1b8860c5.js"><link rel="prefetch" href="/assets/js/235.099f8d57.js"><link rel="prefetch" href="/assets/js/236.0f2e2794.js"><link rel="prefetch" href="/assets/js/237.c24a3987.js"><link rel="prefetch" href="/assets/js/238.24a8c123.js"><link rel="prefetch" href="/assets/js/239.ebbedd8a.js"><link rel="prefetch" href="/assets/js/24.65c88cda.js"><link rel="prefetch" href="/assets/js/240.61aa403a.js"><link rel="prefetch" href="/assets/js/241.40ae6a14.js"><link rel="prefetch" href="/assets/js/242.37049d18.js"><link rel="prefetch" href="/assets/js/243.8f6dabc9.js"><link rel="prefetch" href="/assets/js/244.00bcd6ce.js"><link rel="prefetch" href="/assets/js/245.2809b552.js"><link rel="prefetch" href="/assets/js/246.8b267a20.js"><link rel="prefetch" href="/assets/js/247.a67df8ec.js"><link rel="prefetch" href="/assets/js/248.4f26a33a.js"><link rel="prefetch" href="/assets/js/249.20bcad31.js"><link rel="prefetch" href="/assets/js/25.a1faceee.js"><link rel="prefetch" href="/assets/js/250.99917a60.js"><link rel="prefetch" href="/assets/js/251.bd763793.js"><link rel="prefetch" href="/assets/js/252.d301841d.js"><link rel="prefetch" href="/assets/js/253.8adc730c.js"><link rel="prefetch" href="/assets/js/254.7696fae3.js"><link rel="prefetch" href="/assets/js/255.dc87c295.js"><link rel="prefetch" href="/assets/js/256.b904c661.js"><link rel="prefetch" href="/assets/js/257.a6a4fd25.js"><link rel="prefetch" href="/assets/js/258.33e5aa35.js"><link rel="prefetch" href="/assets/js/259.412ed2c7.js"><link rel="prefetch" href="/assets/js/26.7af4b05a.js"><link rel="prefetch" href="/assets/js/260.52ff3c31.js"><link rel="prefetch" href="/assets/js/261.c2337769.js"><link rel="prefetch" href="/assets/js/262.0d9bfa34.js"><link rel="prefetch" href="/assets/js/263.c8e4cb6a.js"><link rel="prefetch" href="/assets/js/264.3464e615.js"><link rel="prefetch" href="/assets/js/265.5ef49004.js"><link rel="prefetch" href="/assets/js/27.d31fb32e.js"><link rel="prefetch" href="/assets/js/28.ac365b7a.js"><link rel="prefetch" href="/assets/js/29.4ec37ec1.js"><link rel="prefetch" href="/assets/js/30.8e31ec87.js"><link rel="prefetch" href="/assets/js/31.dbca7833.js"><link rel="prefetch" href="/assets/js/32.13f17495.js"><link rel="prefetch" href="/assets/js/33.84403c7c.js"><link rel="prefetch" href="/assets/js/34.ee01958a.js"><link rel="prefetch" href="/assets/js/35.ee834016.js"><link rel="prefetch" href="/assets/js/36.b27e2b58.js"><link rel="prefetch" href="/assets/js/37.5b9c6529.js"><link rel="prefetch" href="/assets/js/38.571abebc.js"><link rel="prefetch" href="/assets/js/39.7faebe0b.js"><link rel="prefetch" href="/assets/js/4.0a0c1c0f.js"><link rel="prefetch" href="/assets/js/40.c06ef95a.js"><link rel="prefetch" href="/assets/js/41.b1778bfc.js"><link rel="prefetch" href="/assets/js/42.a11eb5b9.js"><link rel="prefetch" href="/assets/js/43.dd5a39d2.js"><link rel="prefetch" href="/assets/js/44.e8f62cfa.js"><link rel="prefetch" href="/assets/js/45.019de3b4.js"><link rel="prefetch" href="/assets/js/46.4313681f.js"><link rel="prefetch" href="/assets/js/47.06396028.js"><link rel="prefetch" href="/assets/js/48.e77c89dd.js"><link rel="prefetch" href="/assets/js/49.a888c246.js"><link rel="prefetch" href="/assets/js/50.c81fd93d.js"><link rel="prefetch" href="/assets/js/51.ae7996b0.js"><link rel="prefetch" href="/assets/js/52.6aab4af3.js"><link rel="prefetch" href="/assets/js/53.0bb5c447.js"><link rel="prefetch" href="/assets/js/54.5ba7adba.js"><link rel="prefetch" href="/assets/js/55.d75ad9b1.js"><link rel="prefetch" href="/assets/js/56.a223d4a4.js"><link rel="prefetch" href="/assets/js/57.070c3d14.js"><link rel="prefetch" href="/assets/js/58.c07df3db.js"><link rel="prefetch" href="/assets/js/59.d468a048.js"><link rel="prefetch" href="/assets/js/6.2b00e463.js"><link rel="prefetch" href="/assets/js/60.0859ac91.js"><link rel="prefetch" href="/assets/js/62.e2e00ad4.js"><link rel="prefetch" href="/assets/js/63.ac9ed636.js"><link rel="prefetch" href="/assets/js/64.64603c0c.js"><link rel="prefetch" href="/assets/js/65.74bb2cbb.js"><link rel="prefetch" href="/assets/js/66.1758262f.js"><link rel="prefetch" href="/assets/js/67.5a3aa8f7.js"><link rel="prefetch" href="/assets/js/68.1c081375.js"><link rel="prefetch" href="/assets/js/69.c21e60d5.js"><link rel="prefetch" href="/assets/js/7.31d17e0f.js"><link rel="prefetch" href="/assets/js/70.8a74bf36.js"><link rel="prefetch" href="/assets/js/71.4492ba25.js"><link rel="prefetch" href="/assets/js/72.3296747e.js"><link rel="prefetch" href="/assets/js/73.c2a46fbe.js"><link rel="prefetch" href="/assets/js/74.366bddf4.js"><link rel="prefetch" href="/assets/js/75.e98af08c.js"><link rel="prefetch" href="/assets/js/76.c00e2544.js"><link rel="prefetch" href="/assets/js/77.a150a751.js"><link rel="prefetch" href="/assets/js/78.f3f879f6.js"><link rel="prefetch" href="/assets/js/79.da538e82.js"><link rel="prefetch" href="/assets/js/8.eb90e2e3.js"><link rel="prefetch" href="/assets/js/80.b1c3e778.js"><link rel="prefetch" href="/assets/js/81.3ca1bc6d.js"><link rel="prefetch" href="/assets/js/82.ca162a19.js"><link rel="prefetch" href="/assets/js/83.813d84be.js"><link rel="prefetch" href="/assets/js/84.17e1691d.js"><link rel="prefetch" href="/assets/js/85.dd4423c7.js"><link rel="prefetch" href="/assets/js/86.b25fb906.js"><link rel="prefetch" href="/assets/js/87.66be9b4e.js"><link rel="prefetch" href="/assets/js/88.eadaae8d.js"><link rel="prefetch" href="/assets/js/89.859e72b3.js"><link rel="prefetch" href="/assets/js/9.1d492be9.js"><link rel="prefetch" href="/assets/js/90.cfb6b7b9.js"><link rel="prefetch" href="/assets/js/91.e79aee5d.js"><link rel="prefetch" href="/assets/js/92.68903be5.js"><link rel="prefetch" href="/assets/js/93.60158657.js"><link rel="prefetch" href="/assets/js/94.d2105386.js"><link rel="prefetch" href="/assets/js/95.1c40abf7.js"><link rel="prefetch" href="/assets/js/96.97eb871e.js"><link rel="prefetch" href="/assets/js/97.787d5951.js"><link rel="prefetch" href="/assets/js/98.00721321.js"><link rel="prefetch" href="/assets/js/99.a689649e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.280b48f2.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/favicon1.png" alt="sunnyxujian's blog" class="logo"> <span class="site-name can-hide">sunnyxujian's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><a href="/basic/" class="link-title">前端基础</a> <span class="title" style="display:none;">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/prototype/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/pages/shoucang/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/html/" class="nav-link">HTML和浏览器</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><a href="/framework/" class="link-title">框架</a> <span class="title" style="display:none;">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/pages/vue3/" class="nav-link">Vue3</a></li><li class="dropdown-item"><!----> <a href="/pages/react/" class="nav-link">React</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><a href="/engineering/" class="link-title">工程化</a> <span class="title" style="display:none;">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/engineering/modules/" class="nav-link">基础知识</a></li><li class="dropdown-item"><!----> <a href="/engineering/workflow/" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/engineering/rollup/" class="nav-link">rollup</a></li><li class="dropdown-item"><!----> <a href="/engineering/vite/" class="nav-link">vite</a></li><li class="dropdown-item"><!----> <a href="/engineering/betterConsole/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端进阶" class="dropdown-title"><a href="/advanced/" class="link-title">前端进阶</a> <span class="title" style="display:none;">前端进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/nodejs/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/advanced/net/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/advanced/typescript/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/advanced/codedesign/" class="nav-link">架构设计</a></li><li class="dropdown-item"><!----> <a href="/advanced/optimize/" class="nav-link">性能优化</a></li><li class="dropdown-item"><!----> <a href="/advanced/algorithms/" class="nav-link">数据结构和算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><a href="/notes/" class="link-title">学习笔记</a> <span class="title" style="display:none;">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/javascript/" class="nav-link">JavaScript教程 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/es6/" class="nav-link">ES6 教程 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/typescript-axios/" class="nav-link">TypeScript 从零实现 axios</a></li><li class="dropdown-item"><!----> <a href="/notes/git/" class="nav-link">Git学习 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/render/" class="nav-link">渲染器原理</a></li><li class="dropdown-item"><!----> <a href="/notes/typeScript/" class="nav-link">TypeScript 笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他技术" class="dropdown-title"><a href="/technology/" class="link-title">其他技术</a> <span class="title" style="display:none;">其他技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/techDocs/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/githubUseage/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/pages/techSite/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/techSite/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/pages/usefulSite/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/pages/vueSource/" class="nav-link">Vue资源</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友链&amp;关于" class="dropdown-title"><a href="/friends/" class="link-title">友链&amp;关于</a> <span class="title" style="display:none;">友链&amp;关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友链</a></li><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li></ul></div></div> <a href="https://github.com//sunnyxujian" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://xj-1253772569.file.myqcloud.com/img/mona-loading-default.gif"> <div class="blogger-info"><h3>xujian</h3> <span>劝君惜取少年时。</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><a href="/basic/" class="link-title">前端基础</a> <span class="title" style="display:none;">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/prototype/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/pages/shoucang/" class="nav-link">CSS</a></li><li class="dropdown-item"><!----> <a href="/pages/html/" class="nav-link">HTML和浏览器</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><a href="/framework/" class="link-title">框架</a> <span class="title" style="display:none;">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/vue/" class="nav-link">Vue</a></li><li class="dropdown-item"><!----> <a href="/pages/vue3/" class="nav-link">Vue3</a></li><li class="dropdown-item"><!----> <a href="/pages/react/" class="nav-link">React</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工程化" class="dropdown-title"><a href="/engineering/" class="link-title">工程化</a> <span class="title" style="display:none;">工程化</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/engineering/modules/" class="nav-link">基础知识</a></li><li class="dropdown-item"><!----> <a href="/engineering/workflow/" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/engineering/rollup/" class="nav-link">rollup</a></li><li class="dropdown-item"><!----> <a href="/engineering/vite/" class="nav-link">vite</a></li><li class="dropdown-item"><!----> <a href="/engineering/betterConsole/" class="nav-link">其他</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端进阶" class="dropdown-title"><a href="/advanced/" class="link-title">前端进阶</a> <span class="title" style="display:none;">前端进阶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/advanced/nodejs/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/advanced/net/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/advanced/typescript/" class="nav-link">TypeScript</a></li><li class="dropdown-item"><!----> <a href="/advanced/codedesign/" class="nav-link">架构设计</a></li><li class="dropdown-item"><!----> <a href="/advanced/optimize/" class="nav-link">性能优化</a></li><li class="dropdown-item"><!----> <a href="/advanced/algorithms/" class="nav-link">数据结构和算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="学习笔记" class="dropdown-title"><a href="/notes/" class="link-title">学习笔记</a> <span class="title" style="display:none;">学习笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/notes/javascript/" class="nav-link">JavaScript教程 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/es6/" class="nav-link">ES6 教程 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/typescript-axios/" class="nav-link">TypeScript 从零实现 axios</a></li><li class="dropdown-item"><!----> <a href="/notes/git/" class="nav-link">Git学习 笔记</a></li><li class="dropdown-item"><!----> <a href="/notes/render/" class="nav-link">渲染器原理</a></li><li class="dropdown-item"><!----> <a href="/notes/typeScript/" class="nav-link">TypeScript 笔记</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其他技术" class="dropdown-title"><a href="/technology/" class="link-title">其他技术</a> <span class="title" style="display:none;">其他技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/techDocs/" class="nav-link">技术文档</a></li><li class="dropdown-item"><!----> <a href="/pages/githubUseage/" class="nav-link">GitHub技巧</a></li><li class="dropdown-item"><!----> <a href="/pages/41f87d890d0a02af/" class="nav-link">博客搭建</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="收藏" class="dropdown-title"><a href="/pages/techSite/" class="link-title">收藏</a> <span class="title" style="display:none;">收藏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/techSite/" class="nav-link">网站</a></li><li class="dropdown-item"><!----> <a href="/pages/usefulSite/" class="nav-link">资源</a></li><li class="dropdown-item"><!----> <a href="/pages/vueSource/" class="nav-link">Vue资源</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="友链&amp;关于" class="dropdown-title"><a href="/friends/" class="link-title">友链&amp;关于</a> <span class="title" style="display:none;">友链&amp;关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友链</a></li><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li></ul></div></div> <a href="https://github.com//sunnyxujian" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue3</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>React</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>手写Mini React</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/cc578f/" aria-current="page" class="active sidebar-link">Mini React 之声明式渲染框架</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/cc578f/#_1-命令式和声明式" class="sidebar-link">1. 命令式和声明式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/cc578f/#_1-1-命令式" class="sidebar-link">1.1 命令式</a></li><li class="sidebar-sub-header"><a href="/pages/cc578f/#_1-2-声明式" class="sidebar-link">1.2  声明式</a></li><li class="sidebar-sub-header"><a href="/pages/cc578f/#_1-3-两种范式的性能和易维护性" class="sidebar-link">1.3  两种范式的性能和易维护性</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/cc578f/#_2-虚拟dom的性能如何" class="sidebar-link">2. 虚拟DOM的性能如何</a></li><li class="sidebar-sub-header"><a href="/pages/cc578f/#_3-运行时和编译时" class="sidebar-link">3. 运行时和编译时</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/pages/cc578f/#_3-1-运行时" class="sidebar-link">3.1 运行时</a></li><li class="sidebar-sub-header"><a href="/pages/cc578f/#_3-2-运行时-编译时" class="sidebar-link">3.2 运行时 + 编译时</a></li><li class="sidebar-sub-header"><a href="/pages/cc578f/#_3-3-编译时" class="sidebar-link">3.3 编译时</a></li></ul></li><li class="sidebar-sub-header"><a href="/pages/cc578f/#_4-总结" class="sidebar-link">4. 总结</a></li></ul></li><li><a href="/pages/oversee/" class="sidebar-link">Mini React 之整体架构介绍</a></li><li><a href="/pages/jsx/" class="sidebar-link">Mini React 之JXS介绍及实现</a></li><li><a href="/pages/render/" class="sidebar-link">Mini React 之渲染器</a></li><li><a href="/pages/components/" class="sidebar-link">Mini React 之组件实现</a></li></ul></section></li><li><a href="/pages/react/" class="sidebar-link">由浅到深的React合成事件</a></li><li><a href="/pages/064195/" class="sidebar-link">setState的执行机制</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-583ea4e9><div class="articleInfo" data-v-583ea4e9><ul class="breadcrumbs" data-v-583ea4e9><li data-v-583ea4e9><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-583ea4e9></a></li> <li data-v-583ea4e9><a href="/framework" title="框架-目录页" data-v-583ea4e9>框架</a></li> <li data-v-583ea4e9><a href="/framework/#React" title="框架#React" data-v-583ea4e9>React</a></li> <li data-v-583ea4e9><a href="/framework/#手写Mini React" title="框架#手写Mini React" data-v-583ea4e9>手写Mini React</a></li></ul> <div class="info" data-v-583ea4e9><div title="作者" class="author iconfont icon-touxiang" data-v-583ea4e9><a href="https://github.com/sunnyxujian" target="_blank" title="作者" class="beLink" data-v-583ea4e9>xujian</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-583ea4e9><a href="javascript:;" data-v-583ea4e9>2022-06-02</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">
          Mini React 之声明式渲染框架
        </h1> <!----> <div class="theme-vdoing-content content__default"><p>在学习React源码之前，我们先搞清楚框架的范式都有哪些。框架范式主要有两种：<strong>命令式</strong>和<strong>声明式</strong>，目前大部份流行框架都采用声明式渲染，为什么都选择声明式渲染呢？对比命令式它有什么优势呢？为了搞清楚这些问题，我们先从动态渲染页面的三种方式：纯JS运算，innerHTML，虚拟DOM，分别比较他们的<strong>性能</strong>、<strong>可维护性</strong>和<strong>心智负担</strong>，来阐明基于虚拟DOM声明式渲染的优势。然后会说到与声明式框架密切相关的运行时和编译时。相信看完你会对React、Vue这一类采用虚拟DOM的声明式框架有自己的理解。</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b6ae4af1d6d840e69829c84add7f6449~tplv-k3u1fbpfcp-zoom-1.image" alt="commdOrExp"></p> <h2 id="_1-命令式和声明式"><a href="#_1-命令式和声明式" class="header-anchor">#</a> 1. 命令式和声明式</h2> <p>在对比之前，我们先了解一下什么是声明式，什么是命令式，它们各有什么优缺点。作为框架学习者，了解这两种范式的框架对学习框架思想很有帮助。 我们先看看命令式和声明式框架的概念和具体形式。</p> <h3 id="_1-1-命令式"><a href="#_1-1-命令式" class="header-anchor">#</a> 1.1 命令式</h3> <p>什么是命令式？早年间大范围流行的<code>JQuery</code>就是典型的命令式框架，命令式框架最大的特点是<strong>关注过程</strong>，例如我要做如下DOM操作：</p> <ol><li>获取id为app的div元素</li> <li>把元素的显示文本设置为 hello world</li> <li>给他绑定点击事件</li> <li>事件内容是弹窗提示ok</li></ol> <p>用jQuery可以写出如下代码:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#app&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 2</span>
<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span> <span class="token comment">// 3</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 4</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>可以看到自然语言描述能够跟实际写代码一一对应起来，写代码本身就是在描 <em>述做事的过程</em>，这很符合日常生活的直觉和逻辑。而且整个过程没有任何其他的性能开销，因此命令式框架的性能一搬都非常不错。</p> <h3 id="_1-2-声明式"><a href="#_1-2-声明式" class="header-anchor">#</a> 1.2  声明式</h3> <p>什么是声明式？与命令式框架不同关注过程不同，声明式框架更 <strong>关注结果</strong> ，所见即所得。按照框架的规范，声明出用户想要的结果，具体怎么实现无需关心，都交给框架处理。
同样上面的那个例子里面，用React这种声明式的框架可以这样写:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>hello world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在react里面一般都是用JSX描述页面的dom结构。可以看到我们只需提供一个最终的“结果”，至于具体怎么实现这个结果的过程，我们并不需要关心。换句话说React框架帮我们封装了实现的<strong>过程</strong>，因此应该能够猜到React框架内部实现一定是命令式的，但是暴露给用户的是更加直观的声明式。</p> <h3 id="_1-3-两种范式的性能和易维护性"><a href="#_1-3-两种范式的性能和易维护性" class="header-anchor">#</a> 1.3  两种范式的性能和易维护性</h3> <p>我们首先抛出一个结论：<strong>声明式代码的性能不优于命令式代码的新能</strong>。为什么呢？还是拿上面的例子来说，如果要把文本内容改为：“react”，用命令式代码就很简单，因为用户明确的知道要修改的是什么，直接调用相关api即可：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>app<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'react'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>试想一下，有没有其他的实现方式比这个代码性能更好的？答案是没有，因为我们明确的知道是哪些地方发生了变化，直接修改变化的地方就行， 因此命令式的代码能做到极致的性能优化。但是声明式的代码目前还做不到这一点，因为它表述的是结果：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 之前</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>hello world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token comment">// 之后</span>
<span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>react<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>对于框架来说，为了实现最好的更新性能，框架需要找到新旧DOM的差异，并且只更新有差异的地方，最终还是用命令式的代码完成这次变更：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>app<span class="token punctuation">.</span>textContent <span class="token operator">=</span> <span class="token string">'react'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>如果把修改文本的性能消耗为A，找出新旧内容差异的性能损耗为B，那么会有如下公式：</p> <ul><li>命令式的代码更新性能为：A</li> <li>声明式的代码更新性能为：B + A</li></ul> <p>可以看出，声明式代码比命令式代码多了找出差异的性能消耗，最理想的情况是查找差异性能的消耗为0，此时命令式代码和声明式代码的性能相同，但是无法超过命令式代码。因为<strong>框架本身封装了命令式的代码才实现了面向用户的声明式</strong>，这也侧面印证了之前的结论：<strong>声明式代码的性能不优于命令式代码的新能</strong>。</p> <p>既然命令式代码性能这么好，又直接，为啥还有类似React，Vue这样的声明是框架呢？原因是声明式代码的<strong>可维护性更强</strong>。从之前的例子可以看出，采用命令式代码实现的时候，我们需要关注整个实现过程的每一步，包括DOM元素的创建、获取、更新、删除等操作，过程繁琐而且抽象，心智负担高。而声明式代码展示就是最终我们想要的结果，更加直观，只关注结果效率高，而实现结果的命令式的代码框架内部已经实现，不需要用户关心。</p> <p>但是声明式代码在提升可读性和维护性的同时，面临的问题是性能上有一部分损耗，所以框架要做的是：<strong>保持可维护性的同时让性能损耗最小</strong>。在这种前提下，就有人提出了 <strong>虚拟节点(Virtual DOM)</strong> 这种找出新旧差异的方案，并被广泛运用于React，Vue这类框架之中。那么虚拟DOM的性能到底如何呢？</p> <h2 id="_2-虚拟dom的性能如何"><a href="#_2-虚拟dom的性能如何" class="header-anchor">#</a> 2. 虚拟DOM的性能如何</h2> <p>说到这里相信大家有一个基本的了解，那就是采用虚拟DOM的框架更新新时，<strong>理论上</strong>性能不会比原生JS操作dom性能更好，理论上是指用户写的命令式代码是绝对优化的。在实际场景中这很难，可能需要投入巨大的精力，所以投入产出比不高，目前只谈理论性能。<br>
那么有没有一种办法既不需要投入太大的精力，又能保证代码程序的性能下限，不至于让应用程序性能太差。甚至经过一定的优化处理，接近命令式代码的性能呢？其实这就是虚拟DOM要解决的问题。</p> <p>上文说的原生JS操作dom的命令式代码，指的是document.createElement等方法，不包括innerHTML这个方法，它比较特殊，需要单独探讨它。在早年使用JQuery或直接写原生JS代码的时候，innerHTML操作dom是非常常见的。那么我们可以考虑以下几个问题：</p> <ol><li>innerHTML的渲染流程是什么样的？</li> <li>innerHTML的性能相比较虚拟DOM谁的性能好？</li></ol> <p>首先对于第一个问题，对于innerHTML创建页面，需要先构造一段HTML字符串：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> htmlStr <span class="token operator">=</span> <span class="token string">'&lt;ul&gt;'</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span>data<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
   htmlStr <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;li&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/li&gt;</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
htmlStr <span class="token operator">+=</span> <span class="token string">'&lt;/ul&gt;'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>然后把这个字符串赋值给dom元素的innerHTML属性:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>app<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> htmlStr
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在赋值之后，由于要渲染出页面，首先要吧字符串解析成DOM树，这一步是DOM层面的计算。然而，涉及DOM的运算性能要远比JS层面的计算性能差很多，我们可以在<a href="https://jsbench.me/" target="_blank" rel="noopener noreferrer">jsbench.me<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>这个网站上给它们跑个分，比较创建10000个js对象和10000个dom元素的性能，结果如下：</p> <p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/dba5e74235004bbbbe9cd4fe5cb6a864~tplv-k3u1fbpfcp-zoom-1.image" alt="jsBenchmark"></p> <p>我们可以看出，<strong>纯JS运算要比操作DOM快得多</strong>，他们不在一个数量级上。基于这个前提，我们可以得出innerHTML创建页面的性能为：<strong>拼接HTML字符串的计算量 + innerHTML 的 DOM计算量</strong>。</p> <p>我们再看第二个问题，innerHTML的性能相比较虚拟DOM谁的性能好？我们再看一下虚拟dom创建页面的过程。第一步，先创建JS对象，这个对象是对真实DOM的描述，也就是大家说的虚拟DOM，第二部是递归JS对象并创建所有对应的真实DOM。我们也可以用一个公式来表述他们的性能消耗：<strong>创建JS对象的计算量 + 创建真实DOM的计算量</strong>。</p> <p>1.比方说有这样一个虚拟dom对象：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> vdom <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'ul'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'li'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>2.递归对象创建真实DOM渲染到页面</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">vdom<span class="token punctuation">,</span> anchor</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 <span class="token keyword">const</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>vdom<span class="token punctuation">.</span>type<span class="token punctuation">)</span>
 anchor<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span>vdom<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token function">render</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> el<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">render</span><span class="token punctuation">(</span>vdom<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>我们列一个表格对比一下纯JS运算、虚拟DOM和innerHTML创建页面时所消耗的性能：</p> <table><thead><tr><th>纯JS运算</th> <th>虚拟DOM</th> <th>innerHTML</th></tr></thead> <tbody><tr><td></td> <td>创建js对象(vdom)</td> <td>渲染HTML字符串</td></tr> <tr><td>DOM运算</td> <td>创建所有DOM元素</td> <td>创建所有DOM元素</td></tr></tbody></table> <p>我们可以看出虚拟DOM和innerHTML创建页面时流程差不多，性能两者差别不大。在相同数量级上面，基本上没有什么区别，因为都要新建所有的DOM元素。</p> <p>看到这里可能有人会说，性能都差不多那还要虚拟DOM干嘛，这不是多此一举嘛。别急，上面说的的新创建DOM。在都是新创建所有的DOM元素来说虚拟DOM对比innerHTML在性能上确实没有任何优势可言。但是在我们更新页面的时候，哪怕我们只改了一个字，用innerHTML这种方式更新页面时，<strong>要先销毁之前所有的DOM元素，然后根据新的html字符串重新创建所有的DOM</strong>。我们再看看虚拟DOM是怎么更新页面的，它需要重新创建js对象(vdom)，然后比较新旧虚拟DOM，找到变化的元素然后更新它。如下面这个表格所示：</p> <table><thead><tr><th>纯JS运算</th> <th>虚拟DOM</th> <th>innerHTML</th></tr></thead> <tbody><tr><td></td> <td>1. 创建js对象(vdom) <br> 2. Diff找出变化的部分</td> <td>渲染HTML字符串</td></tr> <tr><td>DOM运算</td> <td>只更新变化的部分DOM</td> <td>1. 创建所有的新DOM元素<br>2. 创建所有的新DOM元素</td></tr></tbody></table> <p>在页面更新的时候，采用虚拟DOM更新页面，由于经过JS计算出哪些DOM元素需要更新，只需要更新对应的DOM元素即可。而采用innerHTML这种方式需要先销毁所有的DOM元素，然后又创建所有DOM。综合之前的JS运算比DOM运算的性能快的多的结论下，这时候虚拟DOM的优势就提现出来了。</p> <p>此外，当页面页面更新时，影响虚拟DOM的性能因素与影响innerHTML的性能因素补贴。对于虚拟DOM来说，无论页面多大，只更新变化的内容，所以性能跟变化内容的大小有关。对innerHTML这种方式来说，就不关系变化内容的大小了，只关心要渲染性能跟html字符串的大小有关。</p> <table><thead><tr><th>纯JS运算</th> <th>虚拟DOM</th> <th>innerHTML</th></tr></thead> <tbody><tr><td></td> <td>1. 创建js对象(vdom) <br> 2. Diff找出变化的部分</td> <td>渲染HTML字符串</td></tr> <tr><td>DOM运算<br>性能因素</td> <td>1. 只更新变化的部分DOM<br>2. 与数据变化量相关</td> <td>1. 创建所有的新DOM元素<br>2. 创建所有的新DOM元素<br>3. 与模板大小相关</td></tr></tbody></table> <p>基于上面的描述，我们可以总结一下原生JS(指createElement等方法)、虚拟DOM、innerHTML这三个方法在更新页面时候的性能，如下表所示：</p> <table><thead><tr><th>纯JS运算</th> <th>虚拟DOM</th> <th>innerHTML</th></tr></thead> <tbody><tr><td>心智负担大</td> <td>心智负担小</td> <td>心智负担小中等</td></tr> <tr><td>性能最好</td> <td>性能不错</td> <td>性能差</td></tr> <tr><td>可维护性差</td> <td>可维护性强</td> <td>可维护性一版</td></tr></tbody></table> <p>我们分了一个维度去考量:心智负担、可维护性、性能：</p> <ul><li>对于纯JS运算，毫无疑问原生JS的DOM操作这种方式心智负担最大，因为需要手动增删改查大量的DOM元素。但它的性能是最好的，不过要承受巨大的心智负担，而且代码可能读性很差，不便于后期维护。</li> <li>对于innerHTML，由于有一部分是拼接字符串来实现的，有点类似于声明式的代码了，但也存在着一定的心智负担，而且其他的DOM操作（绑事件，增加属性等）还是得通过原生JS来处理。此外如果html字符串如果很大的话还可能有性能问题。</li> <li>对于虚拟DOM：由于虚拟DOM是声明式的，心智负担比较小，可维护性强，性能虽然比不上极致优化的原生JS，但是在页面更新的时候也有着不错的性能。</li></ul> <p>一番权衡之后，发现虚拟 DOM 是个还不错的选择。这也是大部份流行框架采用虚拟DOM的原因。</p> <p>可能有的人要问了，有没有一种方法能做到：既可以声明式的描述UI结构，同时又具备原生JS的性能呢？这些问题在下一节讨论。</p> <h2 id="_3-运行时和编译时"><a href="#_3-运行时和编译时" class="header-anchor">#</a> 3. 运行时和编译时</h2> <p>我们先来说一下纯运行时的框架。假如我们设计了一个框架，它提供了一个Render函数，用户只要传入虚拟DOM，Render函数就会递归创建真实DOM把它插入到对应的节点，还是拿之前的代码为例：</p> <h3 id="_3-1-运行时"><a href="#_3-1-运行时" class="header-anchor">#</a> 3.1 运行时</h3> <p>1.虚拟dom对象：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> vdom <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span><span class="token string">'ul'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'li'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>2.创建真实DOM：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token parameter">vdom<span class="token punctuation">,</span> anchor</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
 <span class="token keyword">const</span> el <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span>vdom<span class="token punctuation">.</span>type<span class="token punctuation">)</span>
 anchor<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>
 <span class="token keyword">if</span><span class="token punctuation">(</span>vdom<span class="token punctuation">.</span>children<span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token function">render</span><span class="token punctuation">(</span>children<span class="token punctuation">,</span> el<span class="token punctuation">)</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">render</span><span class="token punctuation">(</span>vdom<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_3-2-运行时-编译时"><a href="#_3-2-运行时-编译时" class="header-anchor">#</a> 3.2 运行时 + 编译时</h3> <p>在浏览器上运行这段代码可以看到预期的结果。但是有人会说，写这样的dom描述对象太不直观了，而且手写起来很麻烦。有没有一种方式能够支持写HTML就能得到dom描述对象呢？答案是有的，我们可以引入编译手段，将写好的HTML编译成dom描述对象，再把这个对象交给Render函数，将他渲染到页面上。流程如下：</p> <ol><li>写了一个Compiler程序，将HTML声明式的代码变成了产出dom描述对象的函数：</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> el <span class="token operator">=</span> <span class="token operator">&lt;</span>div id<span class="token operator">=</span><span class="token string">&quot;app&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>react<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>

<span class="token keyword">const</span> vdom <span class="token operator">=</span> <span class="token function">Compiler</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ol start="2"><li>上面的<code>vdom</code>就会编译成如下结果:</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span> 
    <span class="token function-variable function">click</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">&quot;ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">chilren</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ol start="3"><li>Render函数传入编译得到的dom描述对象就可以把之前声明式的dom节点渲染到页面上了。</li></ol> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">Render</span><span class="token punctuation">(</span>vdom<span class="token punctuation">,</span> container<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>实际上面就是 <strong>运行时 + 编译时</strong> 框架的基本工作流程。用户可以选择提供dom描述对象或者写HTML片段，来描述UI界面，如果是dom描述对象就直接渲染，如果是HTML片段就先编译再渲染。代码运行起来才进行编译，叫做运行编译时，这会产生一定的性能开销，所以有些框架可以在构建的时候执行Compiler将提供的内容
提前编译好，运行的时候就无需编译了，这对程序性能也有一部分提升。像React，Vue就是这么做的。</p> <h3 id="_3-3-编译时"><a href="#_3-3-编译时" class="header-anchor">#</a> 3.3 编译时</h3> <p>有人可能会问了，既然能把能把HTML片段编译成dom描述对象，那为啥不直接HTML片段编译成命令式的代码呢？答案是可以的，这样就不支持任何运行时内容，用户的代码需要编译才能运行，它就是<strong>纯编译时</strong>框架了。目前就有一些框架把声明式的代码编译成命令式代码，例如：<a href="https://www.sveltejs.cn/" target="_blank" rel="noopener noreferrer">sveltejs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://www.solidjs.com/" target="_blank" rel="noopener noreferrer">solidjs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>等框架，它既保持了声明式的易维护特性，又保证了程序的性能。</p> <h2 id="_4-总结"><a href="#_4-总结" class="header-anchor">#</a> 4. 总结</h2> <p>我们先讨论了命令式和声明式这两种范式的差异，其中命令式更加关注过程，而
声明式更加关注结果。命令式在理论上可以做到极致优化，但是用户要承受巨大的心智负担；而
声明式能够有效减轻用户的心智负担，但是性能上有一定的牺牲，框架要想办法尽量使性
能损耗最小化。</p> <p>后面，我们讨论了虚拟 DOM 的性能，并给出了一个公式：声明式的更新性能消耗 = 找出
差异的性能消耗 ＋ 直接修改的性能消耗。虚拟DOM 的意义就在于使找出差异的性能消耗最小
化。我们发现，用原生JavaSoript操作DOM 的方法（如 document.createElement ）、虚拟 DOM 和
tnnerHTML 三者操作页面的性能，不可以简单地下定论，这与页面大小、变更部分的大小都有关
系，除此之外，与创建页面还是更新页面也有关系，选择哪种更新策略，需要我们结合心智负担、
可维护性等因素综合考虑。</p> <p>再后面了解了运行时和编译时的相关知识和各自的特点。</p> <p>下一节我们着重来说一下React声明式框架是如何将JSX创建虚拟DOM，以及虚拟DOM是怎么渲染到页面上的。</p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com//sunnyxujian/edit/master/docs/02.框架/03.React/00.手写Mini React/01.命令式和声明式.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/06/09, 17:20:16</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/pages/ad9668/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">手写vue3-compiler-dom之AST篇</div></a> <a href="/pages/oversee/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Mini React 之整体架构介绍</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/ad9668/" class="prev">手写vue3-compiler-dom之AST篇</a></span> <span class="next"><a href="/pages/oversee/">Mini React 之整体架构介绍</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/de22dd/"><div>😍Vue3和React都在用的函数式编程，学起来~</div></a> <span>02-03</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/29bc3b/"><div>链表</div></a> <span>11-24</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/7f20fa/"><div>基础类型</div></a> <span>11-18</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:1227971544@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/sunnyxujian" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a>Vdoing</a> 
    | Copyright © 2020-2023
    <span>xujian | <a href="https://gitee.com/microjan/blog/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">跟随系统</li><li class="iconfont icon-rijianmoshi">浅色模式</li><li class="iconfont icon-yejianmoshi">深色模式</li><li class="iconfont icon-yuedu">阅读模式</li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div><div class="cat-container" data-v-a13867c0><canvas id="vuepress-cat" width="280" height="250" class="live2d" data-v-a13867c0></canvas></div><!----><div class="RibbonAnimation"></div></div></div>
    <script src="/assets/js/app.d76a6140.js" defer></script><script src="/assets/js/3.724bf448.js" defer></script><script src="/assets/js/5.f79ce4cb.js" defer></script><script src="/assets/js/61.ae4b86ed.js" defer></script>
  </body>
</html>